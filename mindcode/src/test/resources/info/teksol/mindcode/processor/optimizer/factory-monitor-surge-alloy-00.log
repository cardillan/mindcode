   297 instructions before optimizations.
    39 instructions eliminated by Temp Variables Elimination.
    32 instructions eliminated by Dead Code Elimination (4 iterations).
    15 instructions eliminated by Jump Optimization (4 iterations).
    12 instructions eliminated by Single Step Elimination (2 passes, 6 iterations).
     2 instructions eliminated by Expression Optimization (3 iterations).
     2 instructions eliminated by If Expression Optimization (3 iterations).
     1 instructions eliminated by Data Flow Optimization (2 passes, 7 iterations).
     1 instructions added by Loop Optimization (3 iterations).
     2 loops improved by Loop Optimization.
     1 instructions updated by PropagateJumpTargets.
     1 instructions eliminated by Print Merging.
   194 instructions after optimizations.

Pass 1: speed optimization selection (cost limit 804):
  * Loop Optimization: replicate condition at line 26            cost     1, benefit       25,0, efficiency       25,0 (+1 instructions)

Modifications by Initial phase, Temp Variables Elimination, iteration 1 (-39 instructions):
 
     5 set BAR_GAP 22
     6 set CAPACITY 20
     7 op mul __tmp0 EXPECTED_BOOST 16
-    * op div __tmp1 __tmp0 75
-    * set EXPECTED_FLOW __tmp1
+    8 op div EXPECTED_FLOW __tmp0 75
+    9 noop
    10 op mul __tmp2 EXPECTED_FLOW 3600
-    * op floor __tmp3 __tmp2
-    * set EXPECTED_FLOW_STR __tmp3
+   11 op floor EXPECTED_FLOW_STR __tmp2
+   12 noop
    13 set RATE_INDEX 511
    14 op notEqual __tmp4 bank1 null
    15 jump __label0 equal __tmp4 false
 
    35 jump __label5 equal __tmp8 false
    36 op equal __tmp10 FROM_INDEX 0
    37 jump __label7 equal __tmp10 false
-    * read __tmp12 bank1 RATE_INDEX
-    * set rate __tmp12
+   38 read rate bank1 RATE_INDEX
+   39 noop
    40 op notEqual __tmp13 lastRate rate
    41 jump __label9 equal __tmp13 false
    42 draw clear 0 0 80
 
    57 op sub __tmp15 rate EXPECTED_FLOW
    58 op mul __tmp16 84 __tmp15
    59 op div __tmp17 __tmp16 EXPECTED_FLOW
-    * op add __tmp18 88 __tmp17
-    * set pos __tmp18
+   60 op add pos 88 __tmp17
+   61 noop
    62 op max __tmp19 pos 4
-    * op min __tmp20 __tmp19 170
-    * set pos __tmp20
-    * op add __tmp21 pos 7
-    * set pos1 __tmp21
-    * op sub __tmp22 pos 7
-    * set pos2 __tmp22
+   63 op min pos __tmp19 170
+   64 noop
+   65 op add pos1 pos 7
+   66 noop
+   67 op sub pos2 pos 7
+   68 noop
    69 draw color 255 255 16 255
    70 draw triangle 156 pos1 164 pos 156 pos2
    71 op mul __tmp23 3600 rate
-    * op floor __tmp24 __tmp23
-    * set flow_str __tmp24
+   72 op floor flow_str __tmp23
+   73 noop
    74 set __tmp14 flow_str
    75 jump __label10 always
    76 label __label9
 
    94 label __label5
    95 set __tmp9 null
    96 label __label6
-    * set __tmp25 @time
-    * set start __tmp25
+   97 set start @time
+   98 noop
    99 draw stroke 2
   100 set index FROM_INDEX
   101 set n 0
   102 label __label11
   103 op lessThan __tmp26 n @links
   104 jump __label13 equal __tmp26 false
-    * getlink __tmp27 n
-    * set smelter __tmp27
+  105 getlink smelter n
+  106 noop
   107 sensor __tmp28 smelter @type
   108 op equal __tmp29 __tmp28 @surge-smelter
   109 jump __label14 equal __tmp29 false
-    * op add __tmp31 CAPACITY 1
-    * set minimum __tmp31
-    * sensor __tmp32 smelter @titanium
-    * set t __tmp32
-    * sensor __tmp33 smelter @copper
-    * set c __tmp33
-    * sensor __tmp34 smelter @lead
-    * set l __tmp34
-    * sensor __tmp35 smelter @silicon
-    * set s __tmp35
-    * sensor __tmp36 smelter @surge-alloy
-    * set a __tmp36
-    * sensor __tmp37 smelter @enabled
-    * set e __tmp37
-    * sensor __tmp38 smelter @totalPower
-    * set power __tmp38
-    * sensor __tmp39 smelter @timescale
-    * set boost __tmp39
+  110 op add minimum CAPACITY 1
+  111 noop
+  112 sensor t smelter @titanium
+  113 noop
+  114 sensor c smelter @copper
+  115 noop
+  116 sensor l smelter @lead
+  117 noop
+  118 sensor s smelter @silicon
+  119 noop
+  120 sensor a smelter @surge-alloy
+  121 noop
+  122 sensor e smelter @enabled
+  123 noop
+  124 sensor power smelter @totalPower
+  125 noop
+  126 sensor boost smelter @timescale
+  127 noop
   128 op lessThan __tmp40 l minimum
   129 jump __label16 equal __tmp40 false
   130 set minimum l
 
   164 op greaterThan __tmp48 a 5
   165 op sub __tmp49 21 a
   166 op lessThan __tmp50 __tmp49 minimum
-    * op land __tmp51 __tmp48 __tmp50
-    * set showa __tmp51
+  167 op land showa __tmp48 __tmp50
+  168 noop
   169 jump __label24 equal showa false
   170 set icon @surge-alloy
   171 set __tmp52 icon
 
   173 label __label24
   174 set __tmp52 null
   175 label __label25
-    * op mod __tmp53 index 2
-    * set column __tmp53
-    * op idiv __tmp54 index 2
-    * set row __tmp54
+  176 op mod column index 2
+  177 noop
+  178 op idiv row index 2
+  179 noop
   180 op mul __tmp55 column BAR_SPACE
-    * op add __tmp56 OFFSET_X __tmp55
-    * set x __tmp56
+  181 op add x OFFSET_X __tmp55
+  182 noop
   183 op mul __tmp57 row BAR_GAP
-    * op add __tmp58 OFFSET_Y __tmp57
-    * set y __tmp58
-    * op sub __tmp59 x 1
-    * set xm1 __tmp59
-    * op sub __tmp60 y 1
-    * set ym1 __tmp60
+  184 op add y OFFSET_Y __tmp57
+  185 noop
+  186 op sub xm1 x 1
+  187 noop
+  188 op sub ym1 y 1
+  189 noop
   190 draw color 0 0 80 255
   191 draw rect xm1 ym1 BAR_SPACE 16
   192 op greaterThan __tmp61 minimum 16
 
   209 set __tmp67 null
   210 jump __label31 always
   211 label __label30
-    * op add __tmp70 x 12
-    * set x12 __tmp70
-    * op add __tmp71 y 3
-    * set y3 __tmp71
+  212 op add x12 x 12
+  213 noop
+  214 op add y3 y 3
+  215 noop
   216 draw color 255 80 80 255
   217 draw rect x y3 14 8
   218 draw color 0 0 0 255
 
   231 set __tmp65 __tmp67
   232 jump __label29 always
   233 label __label28
-    * op add __tmp77 x 2
-    * set x2 __tmp77
-    * op add __tmp78 y 2
-    * set y2 __tmp78
-    * op add __tmp79 x 12
-    * set x12 __tmp79
-    * op add __tmp80 y 12
-    * set y12 __tmp80
+  234 op add x2 x 2
+  235 noop
+  236 op add y2 y 2
+  237 noop
+  238 op add x12 x 12
+  239 noop
+  240 op add y12 y 12
+  241 noop
   242 draw color 255 80 80 255
   243 draw stroke 3
   244 draw line x2 y12 x12 y2
 
   248 draw stroke 2
   249 set __tmp65 null
   250 label __label29
-    * op add __tmp81 x 16
-    * set x __tmp81
+  251 op add x x 16
+  252 noop
   253 op mul __tmp82 power e
   254 op equal __tmp83 __tmp82 0
   255 jump __label32 equal __tmp83 false
 
   292 label __label33
   293 op greaterThan __tmp92 boost EXPECTED_BOOST
   294 jump __label40 equal __tmp92 false
-    * op max __tmp94 192 red
-    * set red __tmp94
-    * op max __tmp95 192 green
-    * set green __tmp95
-    * op max __tmp96 192 blue
-    * set blue __tmp96
+  295 op max red 192 red
+  296 noop
+  297 op max green 192 green
+  298 noop
+  299 op max blue 192 blue
+  300 noop
   301 set boost EXPECTED_BOOST
   302 set __tmp93 boost
   303 jump __label41 always
 
   305 set __tmp93 null
   306 label __label41
   307 op mul __tmp97 BAR_LENGTH boost
-    * op idiv __tmp98 __tmp97 EXPECTED_BOOST
-    * set length __tmp98
+  308 op idiv length __tmp97 EXPECTED_BOOST
+  309 noop
   310 draw color red green blue 128
   311 op mul __tmp99 minimum length
   312 op idiv __tmp100 __tmp99 CAPACITY
   313 draw rect x y __tmp100 BAR_WIDTH
   314 draw color red green blue 255
   315 draw lineRect x y length BAR_WIDTH
-    * op add __tmp101 index 1
-    * set index __tmp101
+  316 op add index index 1
+  317 noop
   318 set __tmp30 index
   319 jump __label15 always
   320 label __label14
   321 set __tmp30 null
   322 label __label15
   323 label __label12
-    * op add __tmp102 n 1
-    * set n __tmp102
+  324 op add n n 1
+  325 noop
   326 jump __label11 always
   327 label __label13
   328 drawflush display1

Modifications by Initial phase, Dead Code Elimination, iteration 1 (-26 instructions):
 
    15 jump __label0 equal __tmp4 false
    16 set BAR_LENGTH 53
    17 set BAR_SPACE 74
-    * set __tmp5 BAR_SPACE
+   18 noop
    19 jump __label1 always
    20 label __label0
    21 set BAR_LENGTH 61
    22 set BAR_SPACE 88
-    * set __tmp5 BAR_SPACE
+   23 noop
    24 label __label1
    25 set lastRate null
    26 set icon lastRate
 
    78 draw rect 0 0 156 176
    79 set __tmp14 null
    80 label __label10
-    * set __tmp11 __tmp14
+   81 noop
    82 jump __label8 always
    83 label __label7
-    * set __tmp11 null
+   84 noop
    85 label __label8
    86 print "\nNominal production: "
    87 print EXPECTED_FLOW_STR
 
    89 print "\nActual production: "
    90 print flow_str
    91 print "/min"
-    * set __tmp9 null
+   92 noop
    93 jump __label6 always
    94 label __label5
-    * set __tmp9 null
+   95 noop
    96 label __label6
    97 set start @time
    98 noop
 
   129 jump __label16 equal __tmp40 false
   130 set minimum l
   131 set icon @lead
-    * set __tmp41 icon
+  132 noop
   133 jump __label17 always
   134 label __label16
-    * set __tmp41 null
+  135 noop
   136 label __label17
   137 op lessThan __tmp42 s minimum
   138 jump __label18 equal __tmp42 false
   139 set minimum s
   140 set icon @silicon
-    * set __tmp43 icon
+  141 noop
   142 jump __label19 always
   143 label __label18
-    * set __tmp43 null
+  144 noop
   145 label __label19
   146 op lessThan __tmp44 c minimum
   147 jump __label20 equal __tmp44 false
   148 set minimum c
   149 set icon @copper
-    * set __tmp45 icon
+  150 noop
   151 jump __label21 always
   152 label __label20
-    * set __tmp45 null
+  153 noop
   154 label __label21
   155 op lessThan __tmp46 t minimum
   156 jump __label22 equal __tmp46 false
   157 set minimum t
   158 set icon @titanium
-    * set __tmp47 icon
+  159 noop
   160 jump __label23 always
   161 label __label22
-    * set __tmp47 null
+  162 noop
   163 label __label23
   164 op greaterThan __tmp48 a 5
   165 op sub __tmp49 21 a
 
   168 noop
   169 jump __label24 equal showa false
   170 set icon @surge-alloy
-    * set __tmp52 icon
+  171 noop
   172 jump __label25 always
   173 label __label24
-    * set __tmp52 null
+  174 noop
   175 label __label25
   176 op mod column index 2
   177 noop
 
   194 op land __tmp63 __tmp61 __tmp62
   195 jump __label26 equal __tmp63 false
   196 set icon @surge-smelter
-    * set __tmp64 icon
+  197 noop
   198 jump __label27 always
   199 label __label26
-    * set __tmp64 null
+  200 noop
   201 label __label27
   202 draw color 255 255 255 255
   203 jump __label28 equal e false
 
   228 draw rect __tmp75 __tmp76 2 2
   229 set __tmp67 null
   230 label __label31
-    * set __tmp65 __tmp67
+  231 noop
   232 jump __label29 always
   233 label __label28
   234 op add x2 x 2
 
   246 draw color 0 0 0 255
   247 draw lineRect xm1 ym1 16 16
   248 draw stroke 2
-    * set __tmp65 null
+  249 noop
   250 label __label29
   251 op add x x 16
   252 noop
 
   256 set red 255
   257 set green 0
   258 set blue 0
-    * set __tmp84 blue
+  259 noop
   260 jump __label33 always
   261 label __label32
   262 jump __label34 equal showa false
 
   288 set blue 0
   289 set __tmp85 blue
   290 label __label35
-    * set __tmp84 __tmp85
+  291 noop
   292 label __label33
   293 op greaterThan __tmp92 boost EXPECTED_BOOST
   294 jump __label40 equal __tmp92 false
 
   299 op max blue 192 blue
   300 noop
   301 set boost EXPECTED_BOOST
-    * set __tmp93 boost
+  302 noop
   303 jump __label41 always
   304 label __label40
-    * set __tmp93 null
+  305 noop
   306 label __label41
   307 op mul __tmp97 BAR_LENGTH boost
   308 op idiv length __tmp97 EXPECTED_BOOST
 
   315 draw lineRect x y length BAR_WIDTH
   316 op add index index 1
   317 noop
-    * set __tmp30 index
+  318 noop
   319 jump __label15 always
   320 label __label14
-    * set __tmp30 null
+  321 noop
   322 label __label15
   323 label __label12
   324 op add n n 1

Modifications by Initial phase, Dead Code Elimination, iteration 2 (-6 instructions):
 
    71 op mul __tmp23 3600 rate
    72 op floor flow_str __tmp23
    73 noop
-    * set __tmp14 flow_str
+   74 noop
    75 jump __label10 always
    76 label __label9
    77 draw color 0 0 80 255
    78 draw rect 0 0 156 176
-    * set __tmp14 null
+   79 noop
    80 label __label10
    81 noop
    82 jump __label8 always
 
   206 op add __tmp68 x 7
   207 op add __tmp69 y 7
   208 draw image __tmp68 __tmp69 icon 16 0
-    * set __tmp67 null
+  209 noop
   210 jump __label31 always
   211 label __label30
   212 op add x12 x 12
 
   226 op add __tmp75 x 4
   227 op add __tmp76 y 6
   228 draw rect __tmp75 __tmp76 2 2
-    * set __tmp67 null
+  229 noop
   230 label __label31
   231 noop
   232 jump __label29 always
 
   264 set green 0
   265 set blue 255
   266 set minimum a
-    * set __tmp85 minimum
+  267 noop
   268 jump __label35 always
   269 label __label34
   270 op greaterThan __tmp86 minimum 14
 
   286 label __label39
   287 set green __tmp91
   288 set blue 0
-    * set __tmp85 blue
+  289 noop
   290 label __label35
   291 noop
   292 label __label33

Modifications by Iterated phase, Jump Optimization, pass 1, iteration 1 (-15 instructions):
 
    11 op floor EXPECTED_FLOW_STR __tmp2
    12 noop
    13 set RATE_INDEX 511
-    * op notEqual __tmp4 bank1 null
-    * jump __label0 equal __tmp4 false
+   14 jump __label0 equal bank1 null
    15 set BAR_LENGTH 53
    16 set BAR_SPACE 74
    17 noop
 
    27 control enabled switch1 0
    28 label __label2
    29 sensor __tmp6 switch1 @enabled
-    * op equal __tmp7 __tmp6 0
-    * jump __label4 equal __tmp7 false
+   30 jump __label4 notEqual __tmp6 0
    31 print "Surge Alloy Factory Monitor"
-    * op notEqual __tmp8 bank1 null
-    * jump __label5 equal __tmp8 false
-    * op equal __tmp10 FROM_INDEX 0
-    * jump __label7 equal __tmp10 false
+   32 jump __label5 equal bank1 null
+   33 jump __label7 notEqual FROM_INDEX 0
    34 read rate bank1 RATE_INDEX
    35 noop
-    * op notEqual __tmp13 lastRate rate
-    * jump __label9 equal __tmp13 false
+   36 jump __label9 equal lastRate rate
    37 draw clear 0 0 80
    38 set lastRate rate
    39 draw color 0 0 80 255
 
    95 set index FROM_INDEX
    96 set n 0
    97 label __label11
-    * op lessThan __tmp26 n @links
-    * jump __label13 equal __tmp26 false
+   98 jump __label13 greaterThanEq n @links
    99 getlink smelter n
   100 noop
   101 sensor __tmp28 smelter @type
-    * op equal __tmp29 __tmp28 @surge-smelter
-    * jump __label14 equal __tmp29 false
+  102 jump __label14 notEqual __tmp28 @surge-smelter
   103 op add minimum CAPACITY 1
   104 noop
   105 sensor t smelter @titanium
 
   118 noop
   119 sensor boost smelter @timescale
   120 noop
-    * op lessThan __tmp40 l minimum
-    * jump __label16 equal __tmp40 false
+  121 jump __label16 greaterThanEq l minimum
   122 set minimum l
   123 set icon @lead
   124 noop
 
   126 label __label16
   127 noop
   128 label __label17
-    * op lessThan __tmp42 s minimum
-    * jump __label18 equal __tmp42 false
+  129 jump __label18 greaterThanEq s minimum
   130 set minimum s
   131 set icon @silicon
   132 noop
 
   134 label __label18
   135 noop
   136 label __label19
-    * op lessThan __tmp44 c minimum
-    * jump __label20 equal __tmp44 false
+  137 jump __label20 greaterThanEq c minimum
   138 set minimum c
   139 set icon @copper
   140 noop
 
   142 label __label20
   143 noop
   144 label __label21
-    * op lessThan __tmp46 t minimum
-    * jump __label22 equal __tmp46 false
+  145 jump __label22 greaterThanEq t minimum
   146 set minimum t
   147 set icon @titanium
   148 noop
 
   190 label __label27
   191 draw color 255 255 255 255
   192 jump __label28 equal e false
-    * op greaterThan __tmp66 power 0
-    * jump __label30 equal __tmp66 false
+  193 jump __label30 lessThanEq power 0
   194 op add __tmp68 x 7
   195 op add __tmp69 y 7
   196 draw image __tmp68 __tmp69 icon 16 0
 
   239 op add x x 16
   240 noop
   241 op mul __tmp82 power e
-    * op equal __tmp83 __tmp82 0
-    * jump __label32 equal __tmp83 false
+  242 jump __label32 notEqual __tmp82 0
   243 set red 255
   244 set green 0
   245 set blue 0
 
   264 set __tmp89 255
   265 label __label37
   266 set red __tmp89
-    * op greaterThan __tmp90 minimum 7
-    * jump __label38 equal __tmp90 false
+  267 jump __label38 lessThanEq minimum 7
   268 set __tmp91 255
   269 jump __label39 always
   270 label __label38
 
   276 label __label35
   277 noop
   278 label __label33
-    * op greaterThan __tmp92 boost EXPECTED_BOOST
-    * jump __label40 equal __tmp92 false
+  279 jump __label40 lessThanEq boost EXPECTED_BOOST
   280 op max red 192 red
   281 noop
   282 op max green 192 green

Modifications by Iterated phase, Single Step Elimination, pass 1, iteration 1 (-10 instructions):
 
    74 noop
    75 label __label10
    76 noop
-    * jump __label8 always
+   77 noop
    78 label __label7
    79 noop
    80 label __label8
 
    85 print flow_str
    86 print "/min"
    87 noop
-    * jump __label6 always
+   88 noop
    89 label __label5
    90 noop
    91 label __label6
 
   122 set minimum l
   123 set icon @lead
   124 noop
-    * jump __label17 always
+  125 noop
   126 label __label16
   127 noop
   128 label __label17
 
   130 set minimum s
   131 set icon @silicon
   132 noop
-    * jump __label19 always
+  133 noop
   134 label __label18
   135 noop
   136 label __label19
 
   138 set minimum c
   139 set icon @copper
   140 noop
-    * jump __label21 always
+  141 noop
   142 label __label20
   143 noop
   144 label __label21
 
   146 set minimum t
   147 set icon @titanium
   148 noop
-    * jump __label23 always
+  149 noop
   150 label __label22
   151 noop
   152 label __label23
 
   158 jump __label24 equal showa false
   159 set icon @surge-alloy
   160 noop
-    * jump __label25 always
+  161 noop
   162 label __label24
   163 noop
   164 label __label25
 
   184 jump __label26 equal __tmp63 false
   185 set icon @surge-smelter
   186 noop
-    * jump __label27 always
+  187 noop
   188 label __label26
   189 noop
   190 label __label27
 
   285 noop
   286 set boost EXPECTED_BOOST
   287 noop
-    * jump __label41 always
+  288 noop
   289 label __label40
   290 noop
   291 label __label41
 
   301 op add index index 1
   302 noop
   303 noop
-    * jump __label15 always
+  304 noop
   305 label __label14
   306 noop
   307 label __label15

Modifications by Iterated phase, Expression Optimization, pass 1, iteration 1 (-2 instructions):
 
     7 op mul __tmp0 EXPECTED_BOOST 16
     8 op div EXPECTED_FLOW __tmp0 75
     9 noop
-    * op mul __tmp2 EXPECTED_FLOW 3600
-    * op floor EXPECTED_FLOW_STR __tmp2
+   10 noop
+   11 op idiv EXPECTED_FLOW_STR EXPECTED_FLOW 0.0002777777777777778
    12 noop
    13 set RATE_INDEX 511
    14 jump __label0 equal bank1 null
 
    63 noop
    64 draw color 255 255 16 255
    65 draw triangle 156 pos1 164 pos 156 pos2
-    * op mul __tmp23 3600 rate
-    * op floor flow_str __tmp23
+   66 noop
+   67 op idiv flow_str rate 0.0002777777777777778
    68 noop
    69 noop
    70 jump __label10 always

Modifications by Iterated phase, If Expression Optimization, pass 1, iteration 1 (-2 instructions):
 
   254 noop
   255 jump __label35 always
   256 label __label34
+  257 set red 255
   258 op greaterThan __tmp86 minimum 14
   259 op greaterThanEq __tmp87 boost EXPECTED_BOOST
   260 op land __tmp88 __tmp86 __tmp87
-    * jump __label36 equal __tmp88 false
-    * set __tmp89 0
+  261 jump __label37 equal __tmp88 false
+  262 set red 0
   263 jump __label37 always
-    * label __label36
-    * set __tmp89 255
   264 label __label37
-    * set red __tmp89
-    * jump __label38 lessThanEq minimum 7
-    * set __tmp91 255
+  265 set green 0
+  266 jump __label39 lessThanEq minimum 7
+  267 set green 255
   268 jump __label39 always
-    * label __label38
-    * set __tmp91 0
   269 label __label39
-    * set green __tmp91
   270 set blue 0
   271 noop
   272 label __label35

Modifications by Iterated phase, Data Flow Optimization, pass 1, iteration 1:
 
     5 set BAR_GAP 22
     6 set CAPACITY 20
     7 op mul __tmp0 EXPECTED_BOOST 16
-    * op div EXPECTED_FLOW __tmp0 75
+    8 op div EXPECTED_FLOW EXPECTED_BOOST 4.6875
     9 noop
    10 noop
    11 op idiv EXPECTED_FLOW_STR EXPECTED_FLOW 0.0002777777777777778
 
    22 noop
    23 label __label1
    24 set lastRate null
-    * set icon lastRate
-    * set flow_str icon
+   25 set icon null
+   26 set flow_str lastRate
    27 control enabled switch1 0
    28 label __label2
    29 sensor __tmp6 switch1 @enabled

Modifications by Iterated phase, Data Flow Optimization, pass 1, iteration 2 (-1 instructions):
 
     4 set BAR_WIDTH 14
     5 set BAR_GAP 22
     6 set CAPACITY 20
-    * op mul __tmp0 EXPECTED_BOOST 16
     7 op div EXPECTED_FLOW EXPECTED_BOOST 4.6875
     8 noop
     9 noop
 
    22 label __label1
    23 set lastRate null
    24 set icon null
-    * set flow_str lastRate
+   25 set flow_str null
    26 control enabled switch1 0
    27 label __label2
    28 sensor __tmp6 switch1 @enabled

Modifications by Iterated phase, Loop Optimization, pass 1, iteration 1:
 
    95 set n 0
    96 label __label11
    97 jump __label13 greaterThanEq n @links
+   98 label __label42
    99 getlink smelter n
   100 noop
   101 sensor __tmp28 smelter @type
 
   304 label __label12
   305 op add n n 1
   306 noop
-    * jump __label11 always
+  307 jump __label42 lessThan n @links
   308 label __label13
   309 drawflush display1
   310 op sub __tmp103 @time start

Modifications by Loop Optimization: replicate condition at line 26 (+1 instructions):
 
    27 label __label2
    28 sensor __tmp6 switch1 @enabled
    29 jump __label4 notEqual __tmp6 0
+   30 label __label43
    31 print "Surge Alloy Factory Monitor"
    32 jump __label5 equal bank1 null
    33 jump __label7 notEqual FROM_INDEX 0
 
   315 print " ms"
   316 printflush message1
   317 label __label3
-    * jump __label2 always
+  318 sensor __tmp6 switch1 @enabled
+  319 jump __label43 equal __tmp6 0
   320 label __label4
   321 end

Modifications by Iterated phase, Data Flow Optimization, pass 1, iteration 1:
 
    95 set index FROM_INDEX
    96 set n 0
    97 label __label11
-    * jump __label13 greaterThanEq n @links
+   98 jump __label13 greaterThanEq 0 @links
    99 label __label42
   100 getlink smelter n
   101 noop

Modifications by Iterated phase, Single Step Elimination, pass 2, iteration 1 (-2 instructions):
 
   261 op land __tmp88 __tmp86 __tmp87
   262 jump __label37 equal __tmp88 false
   263 set red 0
-    * jump __label37 always
+  264 noop
   265 label __label37
   266 set green 0
   267 jump __label39 lessThanEq minimum 7
   268 set green 255
-    * jump __label39 always
+  269 noop
   270 label __label39
   271 set blue 0
   272 noop

Modifications by Final phase, Jump Threading, iteration 1:
 
   196 op add __tmp69 y 7
   197 draw image __tmp68 __tmp69 icon 16 0
   198 noop
-    * jump __label31 always
+  199 jump __label29 always
   200 label __label30
   201 op add x12 x 12
   202 noop

Modifications by Final phase, Print Merging, iteration 1 (-1 instructions):
 
    80 label __label8
    81 print "\nNominal production: "
    82 print EXPECTED_FLOW_STR
-    * print "/min"
-    * print "\nActual production: "
+   83 print "/min\nActual production: "
    84 print flow_str
    85 print "/min"
    86 noop

Final code before resolving virtual instructions:

set FROM_INDEX 0
set EXPECTED_BOOST 1.5
set OFFSET_X 5
set OFFSET_Y 4
set BAR_WIDTH 14
set BAR_GAP 22
set CAPACITY 20
op div EXPECTED_FLOW EXPECTED_BOOST 4.6875
op idiv EXPECTED_FLOW_STR EXPECTED_FLOW 0.0002777777777777778
set RATE_INDEX 511
jump __label0 equal bank1 null
set BAR_LENGTH 53
set BAR_SPACE 74
jump __label1 always 0 0
label __label0
set BAR_LENGTH 61
set BAR_SPACE 88
label __label1
set lastRate null
set icon null
set flow_str null
control enabled switch1 0 0 0 0
sensor __tmp6 switch1 @enabled
jump __label4 notEqual __tmp6 0
label __label43
print "Surge Alloy Factory Monitor"
jump __label5 equal bank1 null
jump __label7 notEqual FROM_INDEX 0
read rate bank1 RATE_INDEX
jump __label9 equal lastRate rate
draw clear 0 0 80 0 0 0
set lastRate rate
draw color 0 0 80 255 0 0
draw rect 156 0 16 176 0 0
draw color 255 128 128 255 0 0
draw rect 164 4 8 84 0 0
draw color 128 255 128 255 0 0
draw rect 164 89 8 84 0 0
draw stroke 1 0 0 0 0 0
draw color 255 0 0 255 0 0
draw lineRect 164 4 8 84 0 0
draw color 0 255 0 255 0 0
draw lineRect 164 89 8 84 0 0
draw color 0 0 80 255 0 0
draw rect 164 4 2 170 0 0
op sub __tmp15 rate EXPECTED_FLOW
op mul __tmp16 84 __tmp15
op div __tmp17 __tmp16 EXPECTED_FLOW
op add pos 88 __tmp17
op max __tmp19 pos 4
op min pos __tmp19 170
op add pos1 pos 7
op sub pos2 pos 7
draw color 255 255 16 255 0 0
draw triangle 156 pos1 164 pos 156 pos2
op idiv flow_str rate 0.0002777777777777778
jump __label10 always 0 0
label __label9
draw color 0 0 80 255 0 0
draw rect 0 0 156 176 0 0
label __label10
label __label7
print "\nNominal production: "
print EXPECTED_FLOW_STR
print "/min\nActual production: "
print flow_str
print "/min"
label __label5
set start @time
draw stroke 2 0 0 0 0 0
set index FROM_INDEX
set n 0
jump __label13 greaterThanEq 0 @links
label __label42
getlink smelter n
sensor __tmp28 smelter @type
jump __label14 notEqual __tmp28 @surge-smelter
op add minimum CAPACITY 1
sensor t smelter @titanium
sensor c smelter @copper
sensor l smelter @lead
sensor s smelter @silicon
sensor a smelter @surge-alloy
sensor e smelter @enabled
sensor power smelter @totalPower
sensor boost smelter @timescale
jump __label16 greaterThanEq l minimum
set minimum l
set icon @lead
label __label16
jump __label18 greaterThanEq s minimum
set minimum s
set icon @silicon
label __label18
jump __label20 greaterThanEq c minimum
set minimum c
set icon @copper
label __label20
jump __label22 greaterThanEq t minimum
set minimum t
set icon @titanium
label __label22
op greaterThan __tmp48 a 5
op sub __tmp49 21 a
op lessThan __tmp50 __tmp49 minimum
op land showa __tmp48 __tmp50
jump __label24 equal showa false
set icon @surge-alloy
label __label24
op mod column index 2
op idiv row index 2
op mul __tmp55 column BAR_SPACE
op add x OFFSET_X __tmp55
op mul __tmp57 row BAR_GAP
op add y OFFSET_Y __tmp57
op sub xm1 x 1
op sub ym1 y 1
draw color 0 0 80 255 0 0
draw rect xm1 ym1 BAR_SPACE 16 0 0
op greaterThan __tmp61 minimum 16
op equal __tmp62 showa 0
op land __tmp63 __tmp61 __tmp62
jump __label26 equal __tmp63 false
set icon @surge-smelter
label __label26
draw color 255 255 255 255 0 0
jump __label28 equal e false
jump __label30 lessThanEq power 0
op add __tmp68 x 7
op add __tmp69 y 7
draw image __tmp68 __tmp69 icon 16 0 0
jump __label29 always 0 0
label __label30
op add x12 x 12
op add y3 y 3
draw color 255 80 80 255 0 0
draw rect x y3 14 8 0 0
draw color 0 0 0 255 0 0
op add __tmp72 x 2
op add __tmp73 y 5
draw rect __tmp72 __tmp73 8 4 0 0
draw rect x12 y3 2 2 0 0
op add __tmp74 y 9
draw rect x12 __tmp74 2 2 0 0
draw color 255 80 80 255 0 0
op add __tmp75 x 4
op add __tmp76 y 6
draw rect __tmp75 __tmp76 2 2 0 0
jump __label29 always 0 0
label __label28
op add x2 x 2
op add y2 y 2
op add x12 x 12
op add y12 y 12
draw color 255 80 80 255 0 0
draw stroke 3 0 0 0 0 0
draw line x2 y12 x12 y2 0 0
draw line x2 y2 x12 y12 0 0
draw color 0 0 0 255 0 0
draw lineRect xm1 ym1 16 16 0 0
draw stroke 2 0 0 0 0 0
label __label29
op add x x 16
op mul __tmp82 power e
jump __label32 notEqual __tmp82 0
set red 255
set green 0
set blue 0
jump __label33 always 0 0
label __label32
jump __label34 equal showa false
set red 255
set green 0
set blue 255
set minimum a
jump __label35 always 0 0
label __label34
set red 255
op greaterThan __tmp86 minimum 14
op greaterThanEq __tmp87 boost EXPECTED_BOOST
op land __tmp88 __tmp86 __tmp87
jump __label37 equal __tmp88 false
set red 0
label __label37
set green 0
jump __label39 lessThanEq minimum 7
set green 255
label __label39
set blue 0
label __label35
label __label33
jump __label40 lessThanEq boost EXPECTED_BOOST
op max red 192 red
op max green 192 green
op max blue 192 blue
set boost EXPECTED_BOOST
label __label40
op mul __tmp97 BAR_LENGTH boost
op idiv length __tmp97 EXPECTED_BOOST
draw color red green blue 128 0 0
op mul __tmp99 minimum length
op idiv __tmp100 __tmp99 CAPACITY
draw rect x y __tmp100 BAR_WIDTH 0 0
draw color red green blue 255 0 0
draw lineRect x y length BAR_WIDTH 0 0
op add index index 1
label __label14
op add n n 1
jump __label42 lessThan n @links
label __label13
drawflush display1
op sub __tmp103 @time start
op floor __tmp104 __tmp103 0
print "\nUpdate time: "
print __tmp104
print " ms"
printflush message1
sensor __tmp6 switch1 @enabled
jump __label43 equal __tmp6 0
label __label4
end
