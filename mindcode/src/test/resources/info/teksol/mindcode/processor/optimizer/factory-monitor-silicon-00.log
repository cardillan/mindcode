   477 instructions before optimizations.
    48 instructions eliminated by Temp Variables Elimination.
    48 instructions eliminated by Dead Code Elimination (4 iterations).
    26 instructions eliminated by Jump Optimization (4 iterations).
    22 instructions eliminated by Single Step Elimination (2 passes, 6 iterations).
     2 instructions eliminated by Expression Optimization (3 iterations).
     7 instructions eliminated by If Expression Optimization (3 iterations).
    22 instructions eliminated by Data Flow Optimization (2 passes, 8 iterations).
     1 instructions added by Loop Optimization (3 iterations).
     3 loops improved by Loop Optimization.
     2 instructions updated by PropagateJumpTargets.
     1 instructions eliminated by Print Merging.
   302 instructions after optimizations.

Pass 1: speed optimization selection (cost limit 692):
  * Loop Optimization: replicate condition at line 33            cost   1, benefit       25.0, efficiency       25.0 (+1 instructions)

Modifications by Initial phase, Temp Variables Elimination, iteration 1 (-48 instructions):
 
    27 jump __label5 always
    28 label __label4
    29 op mul __tmp6 FROM_INDEX 22
-    * op add __tmp7 4 __tmp6
-    * set __tmp5 __tmp7
+   30 op add __tmp5 4 __tmp6
+   31 noop
    32 label __label5
    33 set cly __tmp5
    34 op lessThan __tmp8 TO_INDEX 8
    35 jump __label6 equal __tmp8 false
    36 op mul __tmp10 TO_INDEX 22
-    * op add __tmp11 4 __tmp10
-    * set __tmp9 __tmp11
+   37 op add __tmp9 4 __tmp10
+   38 noop
    39 jump __label7 always
    40 label __label6
    41 set __tmp9 176
    42 label __label7
-    * op sub __tmp12 __tmp9 cly
-    * set clh __tmp12
+   43 op sub clh __tmp9 cly
+   44 noop
    45 set showa null
    46 set lastRate showa
    47 set flow_str lastRate
 
    52 sensor __tmp13 switch1 @enabled
    53 op equal __tmp14 __tmp13 0
    54 jump __label10 equal __tmp14 false
-    * set __tmp15 @time
-    * set start __tmp15
+   55 set start @time
+   56 noop
    57 print "Silicon Factory Monitor"
    58 set factories 0
    59 draw color 0 0 80 255
 
    64 label __label11
    65 op lessThan __tmp16 n @links
    66 jump __label13 equal __tmp16 false
-    * getlink __tmp17 n
-    * set smelter __tmp17
+   67 getlink smelter n
+   68 noop
    69 sensor __tmp18 smelter @type
    70 op equal __tmp19 __tmp18 @silicon-crucible
    71 jump __label14 equal __tmp19 false
    72 set minimum 31
-    * sensor __tmp21 smelter @sand
-    * set s __tmp21
-    * sensor __tmp22 smelter @coal
-    * set c __tmp22
-    * sensor __tmp23 smelter @pyratite
-    * set p __tmp23
+   73 sensor s smelter @sand
+   74 noop
+   75 sensor c smelter @coal
+   76 noop
+   77 sensor p smelter @pyratite
+   78 noop
    79 sensor __tmp24 smelter @silicon
-    * op min __tmp25 __tmp24 30
-    * set a __tmp25
-    * sensor __tmp26 smelter @enabled
-    * set e __tmp26
-    * sensor __tmp27 smelter @totalPower
-    * set power __tmp27
-    * sensor __tmp28 smelter @timescale
-    * set boost __tmp28
+   80 op min a __tmp24 30
+   81 noop
+   82 sensor e smelter @enabled
+   83 noop
+   84 sensor power smelter @totalPower
+   85 noop
+   86 sensor boost smelter @timescale
+   87 noop
    88 op lessThan __tmp29 s minimum
    89 jump __label16 equal __tmp29 false
    90 set minimum s
 
   115 op greaterThan __tmp35 a 10
   116 op sub __tmp36 31 a
   117 op lessThan __tmp37 __tmp36 minimum
-    * op land __tmp38 __tmp35 __tmp37
-    * set showa __tmp38
+  118 op land showa __tmp35 __tmp37
+  119 noop
   120 jump __label22 equal showa false
   121 set icon @silicon
   122 set __tmp39 icon
 
   127 set column 0
   128 set row index
   129 op mul __tmp40 column BAR_SPACE
-    * op add __tmp41 5 __tmp40
-    * set x __tmp41
+  130 op add x 5 __tmp40
+  131 noop
   132 op mul __tmp42 row 22
-    * op add __tmp43 4 __tmp42
-    * set y __tmp43
+  133 op add y 4 __tmp42
+  134 noop
   135 draw color 0 0 80 255
   136 op sub __tmp44 x 1
   137 op sub __tmp45 y 1
 
   197 draw stroke 2
   198 set __tmp50 null
   199 label __label27
-    * op add __tmp74 x 16
-    * set x __tmp74
+  200 op add x x 16
+  201 noop
   202 op mul __tmp75 power e
   203 op equal __tmp76 __tmp75 0
   204 jump __label30 equal __tmp76 false
 
   241 label __label31
   242 op greaterThan __tmp85 boost EXPECTED_BOOST
   243 jump __label38 equal __tmp85 false
-    * op max __tmp87 192 red
-    * set red __tmp87
-    * op max __tmp88 192 green
-    * set green __tmp88
-    * op max __tmp89 192 blue
-    * set blue __tmp89
+  244 op max red 192 red
+  245 noop
+  246 op max green 192 green
+  247 noop
+  248 op max blue 192 blue
+  249 noop
   250 set boost EXPECTED_BOOST
   251 set __tmp86 boost
   252 jump __label39 always
 
   254 set __tmp86 null
   255 label __label39
   256 op mul __tmp90 BAR_LENGTH boost
-    * op idiv __tmp91 __tmp90 EXPECTED_BOOST
-    * set length __tmp91
+  257 op idiv length __tmp90 EXPECTED_BOOST
+  258 noop
   259 draw color red green blue 128
   260 op mul __tmp92 minimum length
   261 op idiv __tmp93 __tmp92 30
   262 draw rect x y __tmp93 14
   263 draw color red green blue 255
   264 draw lineRect x y length 14
-    * op add __tmp94 index 1
-    * set index __tmp94
-    * op add __tmp95 factories 1
-    * set factories __tmp95
+  265 op add index index 1
+  266 noop
+  267 op add factories factories 1
+  268 noop
   269 set __tmp20 factories
   270 jump __label15 always
   271 label __label14
   272 set __tmp20 null
   273 label __label15
   274 label __label12
-    * op add __tmp96 n 1
-    * set n __tmp96
+  275 op add n n 1
+  276 noop
   277 jump __label11 always
   278 label __label13
   279 set index FROM_INDEX
 
   281 label __label40
   282 op lessThan __tmp97 n @links
   283 jump __label42 equal __tmp97 false
-    * getlink __tmp98 n
-    * set smelter __tmp98
+  284 getlink smelter n
+  285 noop
   286 sensor __tmp99 smelter @type
   287 op equal __tmp100 __tmp99 @pyratite-mixer
   288 jump __label43 equal __tmp100 false
   289 set minimum 11
-    * sensor __tmp102 smelter @sand
-    * set s __tmp102
-    * sensor __tmp103 smelter @coal
-    * set c __tmp103
-    * sensor __tmp104 smelter @lead
-    * set l __tmp104
-    * sensor __tmp105 smelter @pyratite
-    * set a __tmp105
-    * sensor __tmp106 smelter @enabled
-    * set e __tmp106
-    * sensor __tmp107 smelter @totalPower
-    * set power __tmp107
-    * sensor __tmp108 smelter @timescale
-    * set boost __tmp108
+  290 sensor s smelter @sand
+  291 noop
+  292 sensor c smelter @coal
+  293 noop
+  294 sensor l smelter @lead
+  295 noop
+  296 sensor a smelter @pyratite
+  297 noop
+  298 sensor e smelter @enabled
+  299 noop
+  300 sensor power smelter @totalPower
+  301 noop
+  302 sensor boost smelter @timescale
+  303 noop
   304 op lessThan __tmp109 s minimum
   305 jump __label45 equal __tmp109 false
   306 set minimum s
 
   331 set column 1
   332 set row index
   333 op mul __tmp115 column BAR_SPACE
-    * op add __tmp116 5 __tmp115
-    * set x __tmp116
+  334 op add x 5 __tmp115
+  335 noop
   336 op mul __tmp117 row 22
-    * op add __tmp118 4 __tmp117
-    * set y __tmp118
+  337 op add y 4 __tmp117
+  338 noop
   339 draw color 0 0 80 255
   340 op sub __tmp119 x 1
   341 op sub __tmp120 y 1
 
   401 draw stroke 2
   402 set __tmp125 null
   403 label __label54
-    * op add __tmp149 x 16
-    * set x __tmp149
+  404 op add x x 16
+  405 noop
   406 op mul __tmp150 power e
   407 op equal __tmp151 __tmp150 0
   408 jump __label57 equal __tmp151 false
 
   435 label __label58
   436 op greaterThan __tmp159 boost EXPECTED_BOOST
   437 jump __label63 equal __tmp159 false
-    * op max __tmp161 192 red
-    * set red __tmp161
-    * op max __tmp162 192 green
-    * set green __tmp162
-    * op max __tmp163 192 blue
-    * set blue __tmp163
+  438 op max red 192 red
+  439 noop
+  440 op max green 192 green
+  441 noop
+  442 op max blue 192 blue
+  443 noop
   444 set boost EXPECTED_BOOST
   445 set __tmp160 boost
   446 jump __label64 always
 
   448 set __tmp160 null
   449 label __label64
   450 op mul __tmp164 BAR_LENGTH boost
-    * op idiv __tmp165 __tmp164 EXPECTED_BOOST
-    * set length __tmp165
+  451 op idiv length __tmp164 EXPECTED_BOOST
+  452 noop
   453 draw color red green blue 128
   454 op mul __tmp166 minimum length
   455 op idiv __tmp167 __tmp166 10
   456 draw rect x y __tmp167 14
   457 draw color red green blue 255
   458 draw lineRect x y length 14
-    * op add __tmp168 index 1
-    * set index __tmp168
+  459 op add index index 1
+  460 noop
   461 set __tmp101 index
   462 jump __label44 always
   463 label __label43
   464 set __tmp101 null
   465 label __label44
   466 label __label41
-    * op add __tmp169 n 1
-    * set n __tmp169
+  467 op add n n 1
+  468 noop
   469 jump __label40 always
   470 label __label42
   471 op notEqual __tmp170 bank1 null
   472 jump __label65 equal __tmp170 false
   473 op equal __tmp172 FROM_INDEX 0
   474 jump __label67 equal __tmp172 false
-    * read __tmp174 bank1 511
-    * set rate __tmp174
+  475 read rate bank1 511
+  476 noop
   477 op notEqual __tmp175 lastRate rate
   478 jump __label69 equal __tmp175 false
   479 op mul __tmp177 EXPECTED_BOOST factories
-    * op div __tmp178 __tmp177 11.25
-    * set expected_flow __tmp178
+  480 op div expected_flow __tmp177 11.25
+  481 noop
   482 op mul __tmp179 expected_flow 3600
-    * op floor __tmp180 __tmp179
-    * set expected_flow_str __tmp180
+  483 op floor expected_flow_str __tmp179
+  484 noop
   485 set lastRate rate
   486 draw color 0 0 80 255
   487 draw rect 156 0 16 176
 
   499 op sub __tmp181 rate expected_flow
   500 op mul __tmp182 84 __tmp181
   501 op div __tmp183 __tmp182 expected_flow
-    * op add __tmp184 88 __tmp183
-    * set pos __tmp184
+  502 op add pos 88 __tmp183
+  503 noop
   504 op max __tmp185 pos 4
-    * op min __tmp186 __tmp185 170
-    * set pos __tmp186
-    * op add __tmp187 pos 7
-    * set pos1 __tmp187
-    * op sub __tmp188 pos 7
-    * set pos2 __tmp188
+  505 op min pos __tmp185 170
+  506 noop
+  507 op add pos1 pos 7
+  508 noop
+  509 op sub pos2 pos 7
+  510 noop
   511 draw color 255 255 16 255
   512 draw triangle 156 pos1 164 pos 156 pos2
   513 op mul __tmp189 3600 rate
-    * op floor __tmp190 __tmp189
-    * set flow_str __tmp190
+  514 op floor flow_str __tmp189
+  515 noop
   516 set __tmp176 flow_str
   517 jump __label70 always
   518 label __label69

Modifications by Initial phase, Dead Code Elimination, iteration 1 (-40 instructions):
 
     5 jump __label0 equal __tmp0 false
     6 set BAR_LENGTH 53
     7 set BAR_SPACE 74
-    * set __tmp1 BAR_SPACE
+    8 noop
     9 jump __label1 always
    10 label __label0
    11 set BAR_LENGTH 61
    12 set BAR_SPACE 88
-    * set __tmp1 BAR_SPACE
+   13 noop
    14 label __label1
    15 set clx 0
    16 op notEqual __tmp2 bank1 null
 
    89 jump __label16 equal __tmp29 false
    90 set minimum s
    91 set icon @sand
-    * set __tmp30 icon
+   92 noop
    93 jump __label17 always
    94 label __label16
-    * set __tmp30 null
+   95 noop
    96 label __label17
    97 op lessThan __tmp31 c minimum
    98 jump __label18 equal __tmp31 false
    99 set minimum c
   100 set icon @coal
-    * set __tmp32 icon
+  101 noop
   102 jump __label19 always
   103 label __label18
-    * set __tmp32 null
+  104 noop
   105 label __label19
   106 op lessThan __tmp33 p minimum
   107 jump __label20 equal __tmp33 false
   108 set minimum p
   109 set icon @pyratite
-    * set __tmp34 icon
+  110 noop
   111 jump __label21 always
   112 label __label20
-    * set __tmp34 null
+  113 noop
   114 label __label21
   115 op greaterThan __tmp35 a 10
   116 op sub __tmp36 31 a
 
   119 noop
   120 jump __label22 equal showa false
   121 set icon @silicon
-    * set __tmp39 icon
+  122 noop
   123 jump __label23 always
   124 label __label22
-    * set __tmp39 null
+  125 noop
   126 label __label23
   127 set column 0
   128 set row index
 
   141 op land __tmp48 __tmp46 __tmp47
   142 jump __label24 equal __tmp48 false
   143 set icon @silicon-crucible
-    * set __tmp49 icon
+  144 noop
   145 jump __label25 always
   146 label __label24
-    * set __tmp49 null
+  147 noop
   148 label __label25
   149 draw color 255 255 255 255
   150 jump __label26 equal e false
 
   175 draw rect __tmp62 __tmp63 2 2
   176 set __tmp52 null
   177 label __label29
-    * set __tmp50 __tmp52
+  178 noop
   179 jump __label27 always
   180 label __label26
   181 draw color 255 80 80 255
 
   195 op sub __tmp73 y 1
   196 draw lineRect __tmp72 __tmp73 16 16
   197 draw stroke 2
-    * set __tmp50 null
+  198 noop
   199 label __label27
   200 op add x x 16
   201 noop
 
   205 set red 255
   206 set green 0
   207 set blue 0
-    * set __tmp77 blue
+  208 noop
   209 jump __label31 always
   210 label __label30
   211 jump __label32 equal showa false
 
   237 set blue 0
   238 set __tmp78 blue
   239 label __label33
-    * set __tmp77 __tmp78
+  240 noop
   241 label __label31
   242 op greaterThan __tmp85 boost EXPECTED_BOOST
   243 jump __label38 equal __tmp85 false
 
   248 op max blue 192 blue
   249 noop
   250 set boost EXPECTED_BOOST
-    * set __tmp86 boost
+  251 noop
   252 jump __label39 always
   253 label __label38
-    * set __tmp86 null
+  254 noop
   255 label __label39
   256 op mul __tmp90 BAR_LENGTH boost
   257 op idiv length __tmp90 EXPECTED_BOOST
 
   266 noop
   267 op add factories factories 1
   268 noop
-    * set __tmp20 factories
+  269 noop
   270 jump __label15 always
   271 label __label14
-    * set __tmp20 null
+  272 noop
   273 label __label15
   274 label __label12
   275 op add n n 1
 
   305 jump __label45 equal __tmp109 false
   306 set minimum s
   307 set icon @sand
-    * set __tmp110 icon
+  308 noop
   309 jump __label46 always
   310 label __label45
-    * set __tmp110 null
+  311 noop
   312 label __label46
   313 op lessThan __tmp111 c minimum
   314 jump __label47 equal __tmp111 false
   315 set minimum c
   316 set icon @coal
-    * set __tmp112 icon
+  317 noop
   318 jump __label48 always
   319 label __label47
-    * set __tmp112 null
+  320 noop
   321 label __label48
   322 op lessThan __tmp113 l minimum
   323 jump __label49 equal __tmp113 false
   324 set minimum l
   325 set icon @lead
-    * set __tmp114 icon
+  326 noop
   327 jump __label50 always
   328 label __label49
-    * set __tmp114 null
+  329 noop
   330 label __label50
   331 set column 1
   332 set row index
 
   345 op land __tmp123 __tmp121 __tmp122
   346 jump __label51 equal __tmp123 false
   347 set icon @pyratite-mixer
-    * set __tmp124 icon
+  348 noop
   349 jump __label52 always
   350 label __label51
-    * set __tmp124 null
+  351 noop
   352 label __label52
   353 draw color 255 255 255 255
   354 jump __label53 equal e false
 
   379 draw rect __tmp137 __tmp138 2 2
   380 set __tmp127 null
   381 label __label56
-    * set __tmp125 __tmp127
+  382 noop
   383 jump __label54 always
   384 label __label53
   385 draw color 255 80 80 255
 
   399 op sub __tmp148 y 1
   400 draw lineRect __tmp147 __tmp148 16 16
   401 draw stroke 2
-    * set __tmp125 null
+  402 noop
   403 label __label54
   404 op add x x 16
   405 noop
 
   409 set red 255
   410 set green 0
   411 set blue 0
-    * set __tmp152 blue
+  412 noop
   413 jump __label58 always
   414 label __label57
   415 op greaterThan __tmp153 minimum 6
 
   431 label __label62
   432 set green __tmp158
   433 set blue 0
-    * set __tmp152 blue
+  434 noop
   435 label __label58
   436 op greaterThan __tmp159 boost EXPECTED_BOOST
   437 jump __label63 equal __tmp159 false
 
   442 op max blue 192 blue
   443 noop
   444 set boost EXPECTED_BOOST
-    * set __tmp160 boost
+  445 noop
   446 jump __label64 always
   447 label __label63
-    * set __tmp160 null
+  448 noop
   449 label __label64
   450 op mul __tmp164 BAR_LENGTH boost
   451 op idiv length __tmp164 EXPECTED_BOOST
 
   458 draw lineRect x y length 14
   459 op add index index 1
   460 noop
-    * set __tmp101 index
+  461 noop
   462 jump __label44 always
   463 label __label43
-    * set __tmp101 null
+  464 noop
   465 label __label44
   466 label __label41
   467 op add n n 1
 
   518 label __label69
   519 set __tmp176 null
   520 label __label70
-    * set __tmp173 __tmp176
+  521 noop
   522 jump __label68 always
   523 label __label67
-    * set __tmp173 null
+  524 noop
   525 label __label68
   526 print "\nNominal production: "
   527 print expected_flow_str
 
   529 print "\nActual production: "
   530 print flow_str
   531 print "/min"
-    * set __tmp171 "/min"
+  532 noop
   533 jump __label66 always
   534 label __label65
-    * set __tmp171 null
+  535 noop
   536 label __label66
   537 drawflush display1
   538 op sub __tmp191 @time start

Modifications by Initial phase, Dead Code Elimination, iteration 2 (-8 instructions):
 
   153 op add __tmp53 x 7
   154 op add __tmp54 y 7
   155 draw image __tmp53 __tmp54 icon 16 0
-    * set __tmp52 null
+  156 noop
   157 jump __label29 always
   158 label __label28
   159 draw color 255 80 80 255
 
   173 op add __tmp62 x 4
   174 op add __tmp63 y 6
   175 draw rect __tmp62 __tmp63 2 2
-    * set __tmp52 null
+  176 noop
   177 label __label29
   178 noop
   179 jump __label27 always
 
   213 set green 0
   214 set blue 255
   215 set minimum a
-    * set __tmp78 minimum
+  216 noop
   217 jump __label33 always
   218 label __label32
   219 op greaterThan __tmp79 minimum 20
 
   235 label __label37
   236 set green __tmp84
   237 set blue 0
-    * set __tmp78 blue
+  238 noop
   239 label __label33
   240 noop
   241 label __label31
 
   357 op add __tmp128 x 7
   358 op add __tmp129 y 7
   359 draw image __tmp128 __tmp129 icon 16 0
-    * set __tmp127 null
+  360 noop
   361 jump __label56 always
   362 label __label55
   363 draw color 255 80 80 255
 
   377 op add __tmp137 x 4
   378 op add __tmp138 y 6
   379 draw rect __tmp137 __tmp138 2 2
-    * set __tmp127 null
+  380 noop
   381 label __label56
   382 noop
   383 jump __label54 always
 
   513 op mul __tmp189 3600 rate
   514 op floor flow_str __tmp189
   515 noop
-    * set __tmp176 flow_str
+  516 noop
   517 jump __label70 always
   518 label __label69
-    * set __tmp176 null
+  519 noop
   520 label __label70
   521 noop
   522 jump __label68 always

Modifications by Iterated phase, Jump Optimization, pass 1, iteration 1 (-26 instructions):
 
     1 set TO_INDEX 8
     2 set EXPECTED_BOOST 1.5
     3 draw clear 0 0 80
-    * op notEqual __tmp0 bank1 null
-    * jump __label0 equal __tmp0 false
+    4 jump __label0 equal bank1 null
     5 set BAR_LENGTH 53
     6 set BAR_SPACE 74
     7 noop
 
    12 noop
    13 label __label1
    14 set clx 0
-    * op notEqual __tmp2 bank1 null
-    * jump __label2 equal __tmp2 false
+   15 jump __label2 equal bank1 null
    16 set __tmp3 156
    17 jump __label3 always
    18 label __label2
    19 set __tmp3 176
    20 label __label3
    21 set clw __tmp3
-    * op equal __tmp4 FROM_INDEX 0
-    * jump __label4 equal __tmp4 false
+   22 jump __label4 notEqual FROM_INDEX 0
    23 set __tmp5 0
    24 jump __label5 always
    25 label __label4
 
    28 noop
    29 label __label5
    30 set cly __tmp5
-    * op lessThan __tmp8 TO_INDEX 8
-    * jump __label6 equal __tmp8 false
+   31 jump __label6 greaterThanEq TO_INDEX 8
    32 op mul __tmp10 TO_INDEX 22
    33 op add __tmp9 4 __tmp10
    34 noop
 
    46 control enabled switch1 0
    47 label __label8
    48 sensor __tmp13 switch1 @enabled
-    * op equal __tmp14 __tmp13 0
-    * jump __label10 equal __tmp14 false
+   49 jump __label10 notEqual __tmp13 0
    50 set start @time
    51 noop
    52 print "Silicon Factory Monitor"
 
    57 set index FROM_INDEX
    58 set n 0
    59 label __label11
-    * op lessThan __tmp16 n @links
-    * jump __label13 equal __tmp16 false
+   60 jump __label13 greaterThanEq n @links
    61 getlink smelter n
    62 noop
    63 sensor __tmp18 smelter @type
-    * op equal __tmp19 __tmp18 @silicon-crucible
-    * jump __label14 equal __tmp19 false
+   64 jump __label14 notEqual __tmp18 @silicon-crucible
    65 set minimum 31
    66 sensor s smelter @sand
    67 noop
 
    78 noop
    79 sensor boost smelter @timescale
    80 noop
-    * op lessThan __tmp29 s minimum
-    * jump __label16 equal __tmp29 false
+   81 jump __label16 greaterThanEq s minimum
    82 set minimum s
    83 set icon @sand
    84 noop
 
    86 label __label16
    87 noop
    88 label __label17
-    * op lessThan __tmp31 c minimum
-    * jump __label18 equal __tmp31 false
+   89 jump __label18 greaterThanEq c minimum
    90 set minimum c
    91 set icon @coal
    92 noop
 
    94 label __label18
    95 noop
    96 label __label19
-    * op lessThan __tmp33 p minimum
-    * jump __label20 equal __tmp33 false
+   97 jump __label20 greaterThanEq p minimum
    98 set minimum p
    99 set icon @pyratite
   100 noop
 
   138 label __label25
   139 draw color 255 255 255 255
   140 jump __label26 equal e false
-    * op greaterThan __tmp51 power 0
-    * jump __label28 equal __tmp51 false
+  141 jump __label28 lessThanEq power 0
   142 op add __tmp53 x 7
   143 op add __tmp54 y 7
   144 draw image __tmp53 __tmp54 icon 16 0
 
   189 op add x x 16
   190 noop
   191 op mul __tmp75 power e
-    * op equal __tmp76 __tmp75 0
-    * jump __label30 equal __tmp76 false
+  192 jump __label30 notEqual __tmp75 0
   193 set red 255
   194 set green 0
   195 set blue 0
 
   214 set __tmp82 255
   215 label __label35
   216 set red __tmp82
-    * op greaterThan __tmp83 minimum 10
-    * jump __label36 equal __tmp83 false
+  217 jump __label36 lessThanEq minimum 10
   218 set __tmp84 255
   219 jump __label37 always
   220 label __label36
 
   226 label __label33
   227 noop
   228 label __label31
-    * op greaterThan __tmp85 boost EXPECTED_BOOST
-    * jump __label38 equal __tmp85 false
+  229 jump __label38 lessThanEq boost EXPECTED_BOOST
   230 op max red 192 red
   231 noop
   232 op max green 192 green
 
   265 set index FROM_INDEX
   266 set n 0
   267 label __label40
-    * op lessThan __tmp97 n @links
-    * jump __label42 equal __tmp97 false
+  268 jump __label42 greaterThanEq n @links
   269 getlink smelter n
   270 noop
   271 sensor __tmp99 smelter @type
-    * op equal __tmp100 __tmp99 @pyratite-mixer
-    * jump __label43 equal __tmp100 false
+  272 jump __label43 notEqual __tmp99 @pyratite-mixer
   273 set minimum 11
   274 sensor s smelter @sand
   275 noop
 
   285 noop
   286 sensor boost smelter @timescale
   287 noop
-    * op lessThan __tmp109 s minimum
-    * jump __label45 equal __tmp109 false
+  288 jump __label45 greaterThanEq s minimum
   289 set minimum s
   290 set icon @sand
   291 noop
 
   293 label __label45
   294 noop
   295 label __label46
-    * op lessThan __tmp111 c minimum
-    * jump __label47 equal __tmp111 false
+  296 jump __label47 greaterThanEq c minimum
   297 set minimum c
   298 set icon @coal
   299 noop
 
   301 label __label47
   302 noop
   303 label __label48
-    * op lessThan __tmp113 l minimum
-    * jump __label49 equal __tmp113 false
+  304 jump __label49 greaterThanEq l minimum
   305 set minimum l
   306 set icon @lead
   307 noop
 
   333 label __label52
   334 draw color 255 255 255 255
   335 jump __label53 equal e false
-    * op greaterThan __tmp126 power 0
-    * jump __label55 equal __tmp126 false
+  336 jump __label55 lessThanEq power 0
   337 op add __tmp128 x 7
   338 op add __tmp129 y 7
   339 draw image __tmp128 __tmp129 icon 16 0
 
   384 op add x x 16
   385 noop
   386 op mul __tmp150 power e
-    * op equal __tmp151 __tmp150 0
-    * jump __label57 equal __tmp151 false
+  387 jump __label57 notEqual __tmp150 0
   388 set red 255
   389 set green 0
   390 set blue 0
 
   401 set __tmp156 255
   402 label __label60
   403 set red __tmp156
-    * op greaterThan __tmp157 minimum 3
-    * jump __label61 equal __tmp157 false
+  404 jump __label61 lessThanEq minimum 3
   405 set __tmp158 255
   406 jump __label62 always
   407 label __label61
 
   411 set blue 0
   412 noop
   413 label __label58
-    * op greaterThan __tmp159 boost EXPECTED_BOOST
-    * jump __label63 equal __tmp159 false
+  414 jump __label63 lessThanEq boost EXPECTED_BOOST
   415 op max red 192 red
   416 noop
   417 op max green 192 green
 
   445 noop
   446 jump __label40 always
   447 label __label42
-    * op notEqual __tmp170 bank1 null
-    * jump __label65 equal __tmp170 false
-    * op equal __tmp172 FROM_INDEX 0
-    * jump __label67 equal __tmp172 false
+  448 jump __label65 equal bank1 null
+  449 jump __label67 notEqual FROM_INDEX 0
   450 read rate bank1 511
   451 noop
-    * op notEqual __tmp175 lastRate rate
-    * jump __label69 equal __tmp175 false
+  452 jump __label69 equal lastRate rate
   453 op mul __tmp177 EXPECTED_BOOST factories
   454 op div expected_flow __tmp177 11.25
   455 noop

Modifications by Iterated phase, Single Step Elimination, pass 1, iteration 1 (-16 instructions):
 
    82 set minimum s
    83 set icon @sand
    84 noop
-    * jump __label17 always
+   85 noop
    86 label __label16
    87 noop
    88 label __label17
 
    90 set minimum c
    91 set icon @coal
    92 noop
-    * jump __label19 always
+   93 noop
    94 label __label18
    95 noop
    96 label __label19
 
    98 set minimum p
    99 set icon @pyratite
   100 noop
-    * jump __label21 always
+  101 noop
   102 label __label20
   103 noop
   104 label __label21
 
   110 jump __label22 equal showa false
   111 set icon @silicon
   112 noop
-    * jump __label23 always
+  113 noop
   114 label __label22
   115 noop
   116 label __label23
 
   132 jump __label24 equal __tmp48 false
   133 set icon @silicon-crucible
   134 noop
-    * jump __label25 always
+  135 noop
   136 label __label24
   137 noop
   138 label __label25
 
   235 noop
   236 set boost EXPECTED_BOOST
   237 noop
-    * jump __label39 always
+  238 noop
   239 label __label38
   240 noop
   241 label __label39
 
   253 op add factories factories 1
   254 noop
   255 noop
-    * jump __label15 always
+  256 noop
   257 label __label14
   258 noop
   259 label __label15
 
   289 set minimum s
   290 set icon @sand
   291 noop
-    * jump __label46 always
+  292 noop
   293 label __label45
   294 noop
   295 label __label46
 
   297 set minimum c
   298 set icon @coal
   299 noop
-    * jump __label48 always
+  300 noop
   301 label __label47
   302 noop
   303 label __label48
 
   305 set minimum l
   306 set icon @lead
   307 noop
-    * jump __label50 always
+  308 noop
   309 label __label49
   310 noop
   311 label __label50
 
   327 jump __label51 equal __tmp123 false
   328 set icon @pyratite-mixer
   329 noop
-    * jump __label52 always
+  330 noop
   331 label __label51
   332 noop
   333 label __label52
 
   420 noop
   421 set boost EXPECTED_BOOST
   422 noop
-    * jump __label64 always
+  423 noop
   424 label __label63
   425 noop
   426 label __label64
 
   436 op add index index 1
   437 noop
   438 noop
-    * jump __label44 always
+  439 noop
   440 label __label43
   441 noop
   442 label __label44
 
   488 op floor flow_str __tmp189
   489 noop
   490 noop
-    * jump __label70 always
+  491 noop
   492 label __label69
   493 noop
   494 label __label70
   495 noop
-    * jump __label68 always
+  496 noop
   497 label __label67
   498 noop
   499 label __label68
 
   504 print flow_str
   505 print "/min"
   506 noop
-    * jump __label66 always
+  507 noop
   508 label __label65
   509 noop
   510 label __label66

Modifications by Iterated phase, Expression Optimization, pass 1, iteration 1 (-2 instructions):
 
   453 op mul __tmp177 EXPECTED_BOOST factories
   454 op div expected_flow __tmp177 11.25
   455 noop
-    * op mul __tmp179 expected_flow 3600
-    * op floor expected_flow_str __tmp179
+  456 noop
+  457 op idiv expected_flow_str expected_flow 0.0002777777777777778
   458 noop
   459 set lastRate rate
   460 draw color 0 0 80 255
 
   484 noop
   485 draw color 255 255 16 255
   486 draw triangle 156 pos1 164 pos 156 pos2
-    * op mul __tmp189 3600 rate
-    * op floor flow_str __tmp189
+  487 noop
+  488 op idiv flow_str rate 0.0002777777777777778
   489 noop
   490 noop
   491 noop

Modifications by Iterated phase, If Expression Optimization, pass 1, iteration 1 (-7 instructions):
 
    12 noop
    13 label __label1
    14 set clx 0
-    * jump __label2 equal bank1 null
-    * set __tmp3 156
+   15 set clw 176
+   16 jump __label3 equal bank1 null
+   17 set clw 156
    18 jump __label3 always
-    * label __label2
-    * set __tmp3 176
    19 label __label3
-    * set clw __tmp3
-    * jump __label4 notEqual FROM_INDEX 0
-    * set __tmp5 0
-    * jump __label5 always
+   20 set cly 0
+   21 jump __label5 equal FROM_INDEX 0
    22 label __label4
    23 op mul __tmp6 FROM_INDEX 22
-    * op add __tmp5 4 __tmp6
+   24 op add cly 4 __tmp6
    25 noop
    26 label __label5
-    * set cly __tmp5
-    * jump __label6 greaterThanEq TO_INDEX 8
+   27 set __tmp9 176
+   28 jump __label7 greaterThanEq TO_INDEX 8
    29 op mul __tmp10 TO_INDEX 22
    30 op add __tmp9 4 __tmp10
    31 noop
    32 jump __label7 always
-    * label __label6
-    * set __tmp9 176
    33 label __label7
    34 op sub clh __tmp9 cly
    35 noop
 
   199 noop
   200 jump __label33 always
   201 label __label32
+  202 set red 255
   203 op greaterThan __tmp79 minimum 20
   204 op greaterThanEq __tmp80 boost EXPECTED_BOOST
   205 op land __tmp81 __tmp79 __tmp80
-    * jump __label34 equal __tmp81 false
-    * set __tmp82 0
+  206 jump __label35 equal __tmp81 false
+  207 set red 0
   208 jump __label35 always
-    * label __label34
-    * set __tmp82 255
   209 label __label35
-    * set red __tmp82
-    * jump __label36 lessThanEq minimum 10
-    * set __tmp84 255
+  210 set green 0
+  211 jump __label37 lessThanEq minimum 10
+  212 set green 255
   213 jump __label37 always
-    * label __label36
-    * set __tmp84 0
   214 label __label37
-    * set green __tmp84
   215 set blue 0
   216 noop
   217 label __label33
 
   382 noop
   383 jump __label58 always
   384 label __label57
+  385 set red 255
   386 op greaterThan __tmp153 minimum 6
   387 op greaterThanEq __tmp154 boost EXPECTED_BOOST
   388 op land __tmp155 __tmp153 __tmp154
-    * jump __label59 equal __tmp155 false
-    * set __tmp156 0
+  389 jump __label60 equal __tmp155 false
+  390 set red 0
   391 jump __label60 always
-    * label __label59
-    * set __tmp156 255
   392 label __label60
-    * set red __tmp156
-    * jump __label61 lessThanEq minimum 3
-    * set __tmp158 255
+  393 set green 0
+  394 jump __label62 lessThanEq minimum 3
+  395 set green 255
   396 jump __label62 always
-    * label __label61
-    * set __tmp158 0
   397 label __label62
-    * set green __tmp158
   398 set blue 0
   399 noop
   400 label __label58

Modifications by Iterated phase, Data Flow Optimization, pass 1, iteration 1:
 
    34 op sub clh __tmp9 cly
    35 noop
    36 set showa null
-    * set lastRate showa
-    * set flow_str lastRate
-    * set expected_flow_str flow_str
-    * set icon expected_flow_str
+   37 set lastRate null
+   38 set flow_str showa
+   39 set expected_flow_str lastRate
+   40 set icon flow_str
    41 control enabled switch1 0
    42 label __label8
    43 sensor __tmp13 switch1 @enabled
 
    47 print "Silicon Factory Monitor"
    48 set factories 0
    49 draw color 0 0 80 255
-    * draw rect clx cly clw clh
+   50 draw rect 0 cly clw clh
    51 draw stroke 2
    52 set index FROM_INDEX
    53 set n 0
 
    73 noop
    74 sensor boost smelter @timescale
    75 noop
-    * jump __label16 greaterThanEq s minimum
+   76 jump __label16 greaterThanEq s 31
    77 set minimum s
    78 set icon @sand
    79 noop
 
   111 label __label23
   112 set column 0
   113 set row index
-    * op mul __tmp40 column BAR_SPACE
+  114 op mul __tmp40 0 BAR_SPACE
   115 op add x 5 __tmp40
   116 noop
-    * op mul __tmp42 row 22
+  117 op mul __tmp42 index 22
   118 op add y 4 __tmp42
   119 noop
   120 draw color 0 0 80 255
 
   149 draw rect __tmp56 __tmp57 8 4
   150 op add __tmp58 x 12
   151 op add __tmp59 y 3
-    * draw rect __tmp58 __tmp59 2 2
+  152 draw rect __tmp58 __tmp55 2 2
   153 op add __tmp60 x 12
   154 op add __tmp61 y 9
-    * draw rect __tmp60 __tmp61 2 2
+  155 draw rect __tmp58 __tmp61 2 2
   156 draw color 255 80 80 255
   157 op add __tmp62 x 4
   158 op add __tmp63 y 6
 
   173 op add __tmp69 y 2
   174 op add __tmp70 x 12
   175 op add __tmp71 y 12
-    * draw line __tmp68 __tmp69 __tmp70 __tmp71
+  176 draw line __tmp64 __tmp67 __tmp66 __tmp65
   177 draw color 0 0 0 255
   178 op sub __tmp72 x 1
   179 op sub __tmp73 y 1
-    * draw lineRect __tmp72 __tmp73 16 16
+  180 draw lineRect __tmp44 __tmp45 16 16
   181 draw stroke 2
   182 noop
   183 label __label27
 
   276 noop
   277 sensor boost smelter @timescale
   278 noop
-    * jump __label45 greaterThanEq s minimum
+  279 jump __label45 greaterThanEq s 11
   280 set minimum s
   281 set icon @sand
   282 noop
 
   302 label __label50
   303 set column 1
   304 set row index
-    * op mul __tmp115 column BAR_SPACE
+  305 op mul __tmp115 1 BAR_SPACE
   306 op add x 5 __tmp115
   307 noop
-    * op mul __tmp117 row 22
+  308 op mul __tmp117 index 22
   309 op add y 4 __tmp117
   310 noop
   311 draw color 0 0 80 255
 
   340 draw rect __tmp131 __tmp132 8 4
   341 op add __tmp133 x 12
   342 op add __tmp134 y 3
-    * draw rect __tmp133 __tmp134 2 2
+  343 draw rect __tmp133 __tmp130 2 2
   344 op add __tmp135 x 12
   345 op add __tmp136 y 9
-    * draw rect __tmp135 __tmp136 2 2
+  346 draw rect __tmp133 __tmp136 2 2
   347 draw color 255 80 80 255
   348 op add __tmp137 x 4
   349 op add __tmp138 y 6
 
   364 op add __tmp144 y 2
   365 op add __tmp145 x 12
   366 op add __tmp146 y 12
-    * draw line __tmp143 __tmp144 __tmp145 __tmp146
+  367 draw line __tmp139 __tmp142 __tmp141 __tmp140
   368 draw color 0 0 0 255
   369 op sub __tmp147 x 1
   370 op sub __tmp148 y 1
-    * draw lineRect __tmp147 __tmp148 16 16
+  371 draw lineRect __tmp119 __tmp120 16 16
   372 draw stroke 2
   373 noop
   374 label __label54
 
   385 set red 255
   386 op greaterThan __tmp153 minimum 6
   387 op greaterThanEq __tmp154 boost EXPECTED_BOOST
-    * op land __tmp155 __tmp153 __tmp154
+  388 op land __tmp155 __tmp121 __tmp154
   389 jump __label60 equal __tmp155 false
   390 set red 0
   391 jump __label60 always
 
   403 noop
   404 op max green 192 green
   405 noop
-    * op max blue 192 blue
+  406 op max blue 192 0
   407 noop
   408 set boost EXPECTED_BOOST
   409 noop

Modifications by Iterated phase, Data Flow Optimization, pass 1, iteration 2 (-22 instructions):
 
    11 set BAR_SPACE 88
    12 noop
    13 label __label1
-    * set clx 0
    14 set clw 176
    15 jump __label3 equal bank1 null
    16 set clw 156
 
    34 noop
    35 set showa null
    36 set lastRate null
-    * set flow_str showa
-    * set expected_flow_str lastRate
-    * set icon flow_str
+   37 set flow_str null
+   38 set expected_flow_str null
+   39 set icon showa
    40 control enabled switch1 0
    41 label __label8
    42 sensor __tmp13 switch1 @enabled
 
   108 label __label22
   109 noop
   110 label __label23
-    * set column 0
-    * set row index
   111 op mul __tmp40 0 BAR_SPACE
   112 op add x 5 __tmp40
   113 noop
 
   145 op add __tmp57 y 5
   146 draw rect __tmp56 __tmp57 8 4
   147 op add __tmp58 x 12
-    * op add __tmp59 y 3
   148 draw rect __tmp58 __tmp55 2 2
-    * op add __tmp60 x 12
   149 op add __tmp61 y 9
   150 draw rect __tmp58 __tmp61 2 2
   151 draw color 255 80 80 255
 
   164 op add __tmp66 x 12
   165 op add __tmp67 y 2
   166 draw line __tmp64 __tmp65 __tmp66 __tmp67
-    * op add __tmp68 x 2
-    * op add __tmp69 y 2
-    * op add __tmp70 x 12
-    * op add __tmp71 y 12
   167 draw line __tmp64 __tmp67 __tmp66 __tmp65
   168 draw color 0 0 0 255
-    * op sub __tmp72 x 1
-    * op sub __tmp73 y 1
   169 draw lineRect __tmp44 __tmp45 16 16
   170 draw stroke 2
   171 noop
 
   289 label __label49
   290 noop
   291 label __label50
-    * set column 1
-    * set row index
   292 op mul __tmp115 1 BAR_SPACE
   293 op add x 5 __tmp115
   294 noop
 
   326 op add __tmp132 y 5
   327 draw rect __tmp131 __tmp132 8 4
   328 op add __tmp133 x 12
-    * op add __tmp134 y 3
   329 draw rect __tmp133 __tmp130 2 2
-    * op add __tmp135 x 12
   330 op add __tmp136 y 9
   331 draw rect __tmp133 __tmp136 2 2
   332 draw color 255 80 80 255
 
   345 op add __tmp141 x 12
   346 op add __tmp142 y 2
   347 draw line __tmp139 __tmp140 __tmp141 __tmp142
-    * op add __tmp143 x 2
-    * op add __tmp144 y 2
-    * op add __tmp145 x 12
-    * op add __tmp146 y 12
   348 draw line __tmp139 __tmp142 __tmp141 __tmp140
   349 draw color 0 0 0 255
-    * op sub __tmp147 x 1
-    * op sub __tmp148 y 1
   350 draw lineRect __tmp119 __tmp120 16 16
   351 draw stroke 2
   352 noop
 
   362 jump __label58 always
   363 label __label57
   364 set red 255
-    * op greaterThan __tmp153 minimum 6
   365 op greaterThanEq __tmp154 boost EXPECTED_BOOST
   366 op land __tmp155 __tmp121 __tmp154
   367 jump __label60 equal __tmp155 false

Modifications by Iterated phase, Data Flow Optimization, pass 1, iteration 3:
 
    36 set lastRate null
    37 set flow_str null
    38 set expected_flow_str null
-    * set icon showa
+   39 set icon null
    40 control enabled switch1 0
    41 label __label8
    42 sensor __tmp13 switch1 @enabled

Modifications by Iterated phase, Loop Optimization, pass 1, iteration 1:
 
    52 set n 0
    53 label __label11
    54 jump __label13 greaterThanEq n @links
+   55 label __label71
    56 getlink smelter n
    57 noop
    58 sensor __tmp18 smelter @type
 
   241 label __label12
   242 op add n n 1
   243 noop
-    * jump __label11 always
+  244 jump __label71 lessThan n @links
   245 label __label13
   246 set index FROM_INDEX
   247 set n 0
   248 label __label40
   249 jump __label42 greaterThanEq n @links
+  250 label __label72
   251 getlink smelter n
   252 noop
   253 sensor __tmp99 smelter @type
 
   410 label __label41
   411 op add n n 1
   412 noop
-    * jump __label40 always
+  413 jump __label72 lessThan n @links
   414 label __label42
   415 jump __label65 equal bank1 null
   416 jump __label67 notEqual FROM_INDEX 0

Modifications by Loop Optimization: replicate condition at line 33 (+1 instructions):
 
    41 label __label8
    42 sensor __tmp13 switch1 @enabled
    43 jump __label10 notEqual __tmp13 0
+   44 label __label73
    45 set start @time
    46 noop
    47 print "Silicon Factory Monitor"
 
   484 print " ms"
   485 printflush message1
   486 label __label9
-    * jump __label8 always
+  487 sensor __tmp13 switch1 @enabled
+  488 jump __label73 equal __tmp13 0
   489 label __label10
   490 end

Modifications by Iterated phase, Data Flow Optimization, pass 1, iteration 1:
 
    52 set index FROM_INDEX
    53 set n 0
    54 label __label11
-    * jump __label13 greaterThanEq n @links
+   55 jump __label13 greaterThanEq 0 @links
    56 label __label71
    57 getlink smelter n
    58 noop
 
   247 set index FROM_INDEX
   248 set n 0
   249 label __label40
-    * jump __label42 greaterThanEq n @links
+  250 jump __label42 greaterThanEq 0 @links
   251 label __label72
   252 getlink smelter n
   253 noop

Modifications by Iterated phase, Single Step Elimination, pass 2, iteration 1 (-6 instructions):
 
    14 set clw 176
    15 jump __label3 equal bank1 null
    16 set clw 156
-    * jump __label3 always
+   17 noop
    18 label __label3
    19 set cly 0
    20 jump __label5 equal FROM_INDEX 0
 
    28 op mul __tmp10 TO_INDEX 22
    29 op add __tmp9 4 __tmp10
    30 noop
-    * jump __label7 always
+   31 noop
    32 label __label7
    33 op sub clh __tmp9 cly
    34 noop
 
   196 op land __tmp81 __tmp79 __tmp80
   197 jump __label35 equal __tmp81 false
   198 set red 0
-    * jump __label35 always
+  199 noop
   200 label __label35
   201 set green 0
   202 jump __label37 lessThanEq minimum 10
   203 set green 255
-    * jump __label37 always
+  204 noop
   205 label __label37
   206 set blue 0
   207 noop
 
   369 op land __tmp155 __tmp121 __tmp154
   370 jump __label60 equal __tmp155 false
   371 set red 0
-    * jump __label60 always
+  372 noop
   373 label __label60
   374 set green 0
   375 jump __label62 lessThanEq minimum 3
   376 set green 255
-    * jump __label62 always
+  377 noop
   378 label __label62
   379 set blue 0
   380 noop

Modifications by Final phase, Jump Threading, iteration 1:
 
   137 op add __tmp54 y 7
   138 draw image __tmp53 __tmp54 icon 16 0
   139 noop
-    * jump __label29 always
+  140 jump __label27 always
   141 label __label28
   142 draw color 255 80 80 255
   143 op add __tmp55 y 3
 
   319 op add __tmp129 y 7
   320 draw image __tmp128 __tmp129 icon 16 0
   321 noop
-    * jump __label56 always
+  322 jump __label54 always
   323 label __label55
   324 draw color 255 80 80 255
   325 op add __tmp130 y 3

Modifications by Final phase, Print Merging, iteration 1 (-1 instructions):
 
   467 label __label68
   468 print "\nNominal production: "
   469 print expected_flow_str
-    * print "/min"
-    * print "\nActual production: "
+  470 print "/min\nActual production: "
   471 print flow_str
   472 print "/min"
   473 noop

Final code before resolving virtual instructions:

set FROM_INDEX 0
set TO_INDEX 8
set EXPECTED_BOOST 1.5
draw clear 0 0 80 0 0 0
jump __label0 equal bank1 null
set BAR_LENGTH 53
set BAR_SPACE 74
jump __label1 always 0 0
label __label0
set BAR_LENGTH 61
set BAR_SPACE 88
label __label1
set clw 176
jump __label3 equal bank1 null
set clw 156
label __label3
set cly 0
jump __label5 equal FROM_INDEX 0
op mul __tmp6 FROM_INDEX 22
op add cly 4 __tmp6
label __label5
set __tmp9 176
jump __label7 greaterThanEq TO_INDEX 8
op mul __tmp10 TO_INDEX 22
op add __tmp9 4 __tmp10
label __label7
op sub clh __tmp9 cly
set showa null
set lastRate null
set flow_str null
set expected_flow_str null
set icon null
control enabled switch1 0 0 0 0
sensor __tmp13 switch1 @enabled
jump __label10 notEqual __tmp13 0
label __label73
set start @time
print "Silicon Factory Monitor"
set factories 0
draw color 0 0 80 255 0 0
draw rect 0 cly clw clh 0 0
draw stroke 2 0 0 0 0 0
set index FROM_INDEX
set n 0
jump __label13 greaterThanEq 0 @links
label __label71
getlink smelter n
sensor __tmp18 smelter @type
jump __label14 notEqual __tmp18 @silicon-crucible
set minimum 31
sensor s smelter @sand
sensor c smelter @coal
sensor p smelter @pyratite
sensor __tmp24 smelter @silicon
op min a __tmp24 30
sensor e smelter @enabled
sensor power smelter @totalPower
sensor boost smelter @timescale
jump __label16 greaterThanEq s 31
set minimum s
set icon @sand
label __label16
jump __label18 greaterThanEq c minimum
set minimum c
set icon @coal
label __label18
jump __label20 greaterThanEq p minimum
set minimum p
set icon @pyratite
label __label20
op greaterThan __tmp35 a 10
op sub __tmp36 31 a
op lessThan __tmp37 __tmp36 minimum
op land showa __tmp35 __tmp37
jump __label22 equal showa false
set icon @silicon
label __label22
op mul __tmp40 0 BAR_SPACE
op add x 5 __tmp40
op mul __tmp42 index 22
op add y 4 __tmp42
draw color 0 0 80 255 0 0
op sub __tmp44 x 1
op sub __tmp45 y 1
draw rect __tmp44 __tmp45 BAR_SPACE 16 0 0
op greaterThan __tmp46 minimum 26
op equal __tmp47 showa 0
op land __tmp48 __tmp46 __tmp47
jump __label24 equal __tmp48 false
set icon @silicon-crucible
label __label24
draw color 255 255 255 255 0 0
jump __label26 equal e false
jump __label28 lessThanEq power 0
op add __tmp53 x 7
op add __tmp54 y 7
draw image __tmp53 __tmp54 icon 16 0 0
jump __label27 always 0 0
label __label28
draw color 255 80 80 255 0 0
op add __tmp55 y 3
draw rect x __tmp55 14 8 0 0
draw color 0 0 0 255 0 0
op add __tmp56 x 2
op add __tmp57 y 5
draw rect __tmp56 __tmp57 8 4 0 0
op add __tmp58 x 12
draw rect __tmp58 __tmp55 2 2 0 0
op add __tmp61 y 9
draw rect __tmp58 __tmp61 2 2 0 0
draw color 255 80 80 255 0 0
op add __tmp62 x 4
op add __tmp63 y 6
draw rect __tmp62 __tmp63 2 2 0 0
jump __label27 always 0 0
label __label26
draw color 255 80 80 255 0 0
draw stroke 3 0 0 0 0 0
op add __tmp64 x 2
op add __tmp65 y 12
op add __tmp66 x 12
op add __tmp67 y 2
draw line __tmp64 __tmp65 __tmp66 __tmp67 0 0
draw line __tmp64 __tmp67 __tmp66 __tmp65 0 0
draw color 0 0 0 255 0 0
draw lineRect __tmp44 __tmp45 16 16 0 0
draw stroke 2 0 0 0 0 0
label __label27
op add x x 16
op mul __tmp75 power e
jump __label30 notEqual __tmp75 0
set red 255
set green 0
set blue 0
jump __label31 always 0 0
label __label30
jump __label32 equal showa false
set red 255
set green 0
set blue 255
set minimum a
jump __label33 always 0 0
label __label32
set red 255
op greaterThan __tmp79 minimum 20
op greaterThanEq __tmp80 boost EXPECTED_BOOST
op land __tmp81 __tmp79 __tmp80
jump __label35 equal __tmp81 false
set red 0
label __label35
set green 0
jump __label37 lessThanEq minimum 10
set green 255
label __label37
set blue 0
label __label33
label __label31
jump __label38 lessThanEq boost EXPECTED_BOOST
op max red 192 red
op max green 192 green
op max blue 192 blue
set boost EXPECTED_BOOST
label __label38
op mul __tmp90 BAR_LENGTH boost
op idiv length __tmp90 EXPECTED_BOOST
draw color red green blue 128 0 0
op mul __tmp92 minimum length
op idiv __tmp93 __tmp92 30
draw rect x y __tmp93 14 0 0
draw color red green blue 255 0 0
draw lineRect x y length 14 0 0
op add index index 1
op add factories factories 1
label __label14
op add n n 1
jump __label71 lessThan n @links
label __label13
set index FROM_INDEX
set n 0
jump __label42 greaterThanEq 0 @links
label __label72
getlink smelter n
sensor __tmp99 smelter @type
jump __label43 notEqual __tmp99 @pyratite-mixer
set minimum 11
sensor s smelter @sand
sensor c smelter @coal
sensor l smelter @lead
sensor a smelter @pyratite
sensor e smelter @enabled
sensor power smelter @totalPower
sensor boost smelter @timescale
jump __label45 greaterThanEq s 11
set minimum s
set icon @sand
label __label45
jump __label47 greaterThanEq c minimum
set minimum c
set icon @coal
label __label47
jump __label49 greaterThanEq l minimum
set minimum l
set icon @lead
label __label49
op mul __tmp115 1 BAR_SPACE
op add x 5 __tmp115
op mul __tmp117 index 22
op add y 4 __tmp117
draw color 0 0 80 255 0 0
op sub __tmp119 x 1
op sub __tmp120 y 1
draw rect __tmp119 __tmp120 BAR_SPACE 16 0 0
op greaterThan __tmp121 minimum 6
op equal __tmp122 showa 0
op land __tmp123 __tmp121 __tmp122
jump __label51 equal __tmp123 false
set icon @pyratite-mixer
label __label51
draw color 255 255 255 255 0 0
jump __label53 equal e false
jump __label55 lessThanEq power 0
op add __tmp128 x 7
op add __tmp129 y 7
draw image __tmp128 __tmp129 icon 16 0 0
jump __label54 always 0 0
label __label55
draw color 255 80 80 255 0 0
op add __tmp130 y 3
draw rect x __tmp130 14 8 0 0
draw color 0 0 0 255 0 0
op add __tmp131 x 2
op add __tmp132 y 5
draw rect __tmp131 __tmp132 8 4 0 0
op add __tmp133 x 12
draw rect __tmp133 __tmp130 2 2 0 0
op add __tmp136 y 9
draw rect __tmp133 __tmp136 2 2 0 0
draw color 255 80 80 255 0 0
op add __tmp137 x 4
op add __tmp138 y 6
draw rect __tmp137 __tmp138 2 2 0 0
jump __label54 always 0 0
label __label53
draw color 255 80 80 255 0 0
draw stroke 3 0 0 0 0 0
op add __tmp139 x 2
op add __tmp140 y 12
op add __tmp141 x 12
op add __tmp142 y 2
draw line __tmp139 __tmp140 __tmp141 __tmp142 0 0
draw line __tmp139 __tmp142 __tmp141 __tmp140 0 0
draw color 0 0 0 255 0 0
draw lineRect __tmp119 __tmp120 16 16 0 0
draw stroke 2 0 0 0 0 0
label __label54
op add x x 16
op mul __tmp150 power e
jump __label57 notEqual __tmp150 0
set red 255
set green 0
set blue 0
jump __label58 always 0 0
label __label57
set red 255
op greaterThanEq __tmp154 boost EXPECTED_BOOST
op land __tmp155 __tmp121 __tmp154
jump __label60 equal __tmp155 false
set red 0
label __label60
set green 0
jump __label62 lessThanEq minimum 3
set green 255
label __label62
set blue 0
label __label58
jump __label63 lessThanEq boost EXPECTED_BOOST
op max red 192 red
op max green 192 green
op max blue 192 0
set boost EXPECTED_BOOST
label __label63
op mul __tmp164 BAR_LENGTH boost
op idiv length __tmp164 EXPECTED_BOOST
draw color red green blue 128 0 0
op mul __tmp166 minimum length
op idiv __tmp167 __tmp166 10
draw rect x y __tmp167 14 0 0
draw color red green blue 255 0 0
draw lineRect x y length 14 0 0
op add index index 1
label __label43
op add n n 1
jump __label72 lessThan n @links
label __label42
jump __label65 equal bank1 null
jump __label67 notEqual FROM_INDEX 0
read rate bank1 511
jump __label69 equal lastRate rate
op mul __tmp177 EXPECTED_BOOST factories
op div expected_flow __tmp177 11.25
op idiv expected_flow_str expected_flow 0.0002777777777777778
set lastRate rate
draw color 0 0 80 255 0 0
draw rect 156 0 16 176 0 0
draw color 255 128 128 255 0 0
draw rect 164 4 8 84 0 0
draw color 128 255 128 255 0 0
draw rect 164 89 8 84 0 0
draw stroke 1 0 0 0 0 0
draw color 255 0 0 255 0 0
draw lineRect 164 4 8 84 0 0
draw color 0 255 0 255 0 0
draw lineRect 164 89 8 84 0 0
draw color 0 0 80 255 0 0
draw rect 164 4 2 170 0 0
op sub __tmp181 rate expected_flow
op mul __tmp182 84 __tmp181
op div __tmp183 __tmp182 expected_flow
op add pos 88 __tmp183
op max __tmp185 pos 4
op min pos __tmp185 170
op add pos1 pos 7
op sub pos2 pos 7
draw color 255 255 16 255 0 0
draw triangle 156 pos1 164 pos 156 pos2
op idiv flow_str rate 0.0002777777777777778
label __label69
label __label67
print "\nNominal production: "
print expected_flow_str
print "/min\nActual production: "
print flow_str
print "/min"
label __label65
drawflush display1
op sub __tmp191 @time start
op floor __tmp192 __tmp191 0
print "\nUpdate time: "
print __tmp192
print " ms"
printflush message1
sensor __tmp13 switch1 @enabled
jump __label73 equal __tmp13 0
label __label10
end
