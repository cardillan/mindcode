   664 instructions before optimizations.
    71 instructions eliminated by Temp Variables Elimination.
     4 instructions eliminated by Case Expression Optimization.
    85 instructions eliminated by Dead Code Elimination (6 iterations).
     2 instructions eliminated by Jump Normalization (2 passes, 5 iterations).
    25 instructions eliminated by Jump Optimization (5 iterations).
    32 instructions eliminated by Single Step Elimination (3 passes, 8 iterations).
     1 instructions eliminated by Expression Optimization (2 passes, 4 iterations).
     2 instructions eliminated by If Expression Optimization (2 passes, 4 iterations).
    44 instructions eliminated by Data Flow Optimization (2 passes, 8 iterations).
     1 instructions eliminated by Loop Optimization (4 iterations).
     3 loops improved by Loop Optimization.
    11 instructions eliminated by Jump Straightening (5 iterations).
    10 instructions updated by PropagateJumpTargets.
     1 instructions eliminated by Unreachable Code Elimination.
     2 instructions eliminated by Print Merging.
   383 instructions after optimizations.

Final code before resolving virtual instructions:

set START 0
set FUEL_FLAG 0
set COOLANT_FLAG 0
label __label118
set reactors 0
set n @links
jump __label5 lessThanEq n 0
label __label119
op sub n n 1
getlink block n
print "Found: "
print block
print "\n"
sensor __tmp8 block @type
jump __label7 notEqual __tmp8 @impact-reactor
set START n
op add reactors reactors 1
jump __label6 always 0 0
label __label7
jump __label10 equal __tmp8 @overdrive-projector
jump __label9 notEqual __tmp8 @overdrive-dome
label __label10
set START n
label __label9
label __label6
jump __label119 greaterThan n 0
label __label5
read __tmp11 cell2 1
op add reactors reactors __tmp11
jump __label11 notEqual reactors 0
print "No reactor."
label __label11
printflush message1
jump __label118 equal reactors 0
read MODE cell1 0
read OUTPUT_1 cell1 1
read OUTPUT_2 cell1 2
read OUTPUT_3 cell1 3
read REACTORS_ON cell1 4
read OVERDRIVE cell1 5
read GENERATOR cell1 6
read CAN_COMMIT cell1 7
read STARTUPS cell1 8
read RESETS cell1 9
read COMMITS cell1 10
set reactors REACTORS_ON
set REASON "Reason unknown -- out of power?"
jump __label14 notEqual MODE 0
set REASON "Processor reset"
label __label14
op notEqual __tmp28 MODE 0
control enabled switch1 __tmp28 0 0 0
set failure_cnt 0
set boosts 0
set nextStart 0
op add nextDecommit @time 6000
label __label15
sensor __tmp30 battery1 @totalPower
op floor battery_level __tmp30 0
op idiv battery_level_str battery_level 1000
sensor __tmp33 battery1 @powerNetStored
op floor total_battery __tmp33 0
op idiv total_battery_str total_battery 1000
sensor consumption battery1 @powerNetOut
read production bank1 509
read net_power bank1 510
read battery_change bank1 511
sensor total_capacity battery1 @powerNetCapacity
op idiv total_capacity_str total_capacity 1000
op mul required_capacity 100000 reactors
op greaterThanEq enough_battery total_capacity required_capacity
op sub __tmp44 required_capacity total_capacity
op div __tmp45 __tmp44 1000
op ceil missing_battery __tmp45 0
jump __label18 equal MODE 0
sensor __tmp49 switch1 @enabled
jump __label20 notEqual __tmp49 false
set MODE 0
set REASON "Manual power off"
jump __label21 always 0 0
label __label20
op mul min_consumption REACTORS_ON 1200
op lessThan failure1 consumption min_consumption
op equal __tmp54 battery_level 0
op greaterThan __tmp55 consumption 0
op land __tmp56 __tmp54 __tmp55
op equal __tmp57 production 0
op land failure2 __tmp56 __tmp57
op or __tmp59 failure1 failure2
jump __label22 equal __tmp59 false
op add failure_cnt failure_cnt 1
read __tmp62 cell2 1
op add __tmp63 10 __tmp62
jump __label23 lessThanEq failure_cnt __tmp63
set MODE 0
control enabled switch1 false 0 0 0
set REASON "Unknown -- out of power?"
print "Consumption: "
print consumption
print "\nMin. consumption: "
print min_consumption
printflush message2
jump __label23 always 0 0
label __label22
set failure_cnt 0
label __label23
label __label21
label __label18
jump __label27 notEqual MODE 0
set __tmp66 "[salmon]SHUTDOWN[]"
jump __label26 always 0 0
label __label27
jump __label29 notEqual MODE 1
set __tmp66 "[gold]STARTUP[]"
jump __label26 always 0 0
label __label29
jump __label31 notEqual MODE 2
set __tmp66 "[green]RUNNING[]"
jump __label26 always 0 0
label __label31
set __tmp66 null
label __label26
print __tmp66
print ", reactors [green]"
print REACTORS_ON
print "/"
print reactors
print "[]"
jump __label33 equal OVERDRIVE false
op mul __tmp68 100 boosts
op div __tmp69 __tmp68 REACTORS_ON
op add __tmp70 __tmp69 0.5
op floor __tmp71 __tmp70 0
op div multiplier __tmp71 100
print " ([gold]"
print multiplier
print "x[])"
label __label33
print "\n=================================="
sensor __tmp73 tank1 @totalLiquids
jump __label35 greaterThanEq __tmp73 750
print "\n[salmon]Cryofluid level critical![]"
label __label35
sensor __tmp76 vault1 @blast-compound
jump __label37 greaterThanEq __tmp76 700
print "\n[salmon]Blast compound level critical![]"
label __label37
jump __label39 notEqual enough_battery false
print "\n[salmon]Insufficient battery storage![]"
print "\nLink [gold]"
print missing_battery
print " K[] of additional storage to internal battery."
label __label39
print "\nInternal battery:    [gold]"
print battery_level_str
print "[]/[green]50[] K"
print "\nTotal battery:        [gold]"
print total_battery_str
print "[]/[green]"
print total_capacity_str
print "[] K\nBattery change:     [gold]"
print battery_change
print "[]\nPower balance:       [gold]"
print net_power
print "[]"
jump __label42 notEqual MODE 0
set REACTORS_ON 0
set OVERDRIVE 0
set OUTPUT_1 0
set OUTPUT_2 0
set OUTPUT_3 0
op greaterThanEq __tmp82 net_power -150
op lessThan __tmp83 total_battery 47500
op land GENERATOR __tmp82 __tmp83
print "\nShutdown reason: [gold]"
print REASON
print "[]"
sensor __tmp85 switch1 @enabled
jump __label41 equal __tmp85 false
set MODE 1
op add STARTUPS STARTUPS 1
set nextStart 0
set failure_cnt 0
set GENERATOR true
set REASON "Unknown -- out of power?"
jump __label41 always 0 0
label __label42
jump __label46 notEqual MODE 1
sensor __tmp90 battery2 @powerNetOut
jump __label49 equal OUTPUT_1 false
sensor __tmp90 battery3 @powerNetOut
jump __label51 equal OUTPUT_2 false
sensor __tmp90 battery4 @powerNetOut
label __label51
label __label49
op idiv __tmp92 __tmp90 0.9523809523809523
op max neededPower __tmp92 1000
jump __label52 notEqual REACTORS_ON 0
jump __label54 lessThan total_battery 25000
set REACTORS_ON 1
op add nextStart @time 2000
jump __label41 always 0 0
label __label54
print "\nRequired startup energy: [gold]"
print 25
print " K[]"
jump __label41 always 0 0
label __label52
op add __tmp100 OUTPUT_1 OUTPUT_2
op add outputs __tmp100 OUTPUT_3
print "\n[gold]"
print outputs
print "[] surge tower(s) online"
jump __label56 notEqual OUTPUT_3 0
print "\nRequired power level: [gold]"
print neededPower
print "[]"
label __label56
jump __label58 lessThanEq net_power 100
set OVERDRIVE true
label __label58
op lessThan __tmp106 REACTORS_ON reactors
op greaterThan __tmp107 net_power 1000
op land __tmp108 __tmp106 __tmp107
op greaterThanEq __tmp109 total_battery 25000
op land canStart __tmp108 __tmp109
jump __label60 lessThan net_power neededPower
set OUTPUT_3 OUTPUT_2
set OUTPUT_2 OUTPUT_1
set OUTPUT_1 1
label __label60
jump __label62 notEqual OUTPUT_1 0
op mul availablePower 6300 boosts
op div ratio neededPower availablePower
jump __label64 greaterThanEq ratio 1
op add nextStart @time 2000
label __label64
label __label62
op greaterThan __tmp120 @time nextStart
op land __tmp121 canStart __tmp120
jump __label66 equal __tmp121 false
op idiv __tmp123 total_battery 25000
op add __tmp125 REACTORS_ON __tmp123
op min REACTORS_ON __tmp125 reactors
op add nextStart @time 2000
label __label66
op greaterThanEq __tmp128 REACTORS_ON reactors
op greaterThan __tmp129 @time nextStart
op land __tmp130 __tmp128 __tmp129
op greaterThan __tmp131 OUTPUT_3 0
op land __tmp132 __tmp130 __tmp131
jump __label41 equal __tmp132 false
set MODE 2
op add nextDecommit @time 6000
set COOLANT_FLAG 0
set FUEL_FLAG 0
set GENERATOR false
jump __label41 always 0 0
label __label46
jump __label72 notEqual MODE 2
sensor __tmp135 tank1 @totalLiquids
op lessThan __tmp136 __tmp135 750
op land __tmp137 COOLANT_FLAG __tmp136
jump __label74 equal __tmp137 false
set MODE 0
control enabled switch1 false 0 0 0
set REASON "Cryo level too low"
label __label74
sensor __tmp139 vault1 @blast-compound
op lessThan __tmp140 __tmp139 700
op land __tmp141 FUEL_FLAG __tmp140
jump __label76 equal __tmp141 false
set MODE 0
control enabled switch1 false 0 0 0
set REASON "Blast compound level too low"
label __label76
sensor __tmp143 tank1 @totalLiquids
op greaterThan __tmp144 __tmp143 1000
op or COOLANT_FLAG COOLANT_FLAG __tmp144
sensor __tmp146 vault1 @blast-compound
op greaterThan __tmp147 __tmp146 800
op or FUEL_FLAG FUEL_FLAG __tmp147
sensor __tmp149 switch2 @enabled
op land __tmp150 enough_battery __tmp149
jump __label78 equal __tmp150 false
op mul min_level reactors 50000
set commit_level 0
op lessThan __tmp153 battery_change 0
op land __tmp154 CAN_COMMIT __tmp153
op lessThan __tmp155 REACTORS_ON reactors
op land __tmp156 __tmp154 __tmp155
jump __label80 equal __tmp156 false
op sub p battery_change 2500
op mul __tmp160 p 0.00472972972972973
op add __tmp161 5 __tmp160
op mul __tmp162 p __tmp161
op add commit_margin 25000 __tmp162
op add commit_level min_level commit_margin
op idiv __tmp165 commit_level 1000
print "\nCommit threshold:   [gold]"
print __tmp165
label __label80
jump __label82 notEqual commit_level 0
op idiv __tmp168 min_level 1000
print "\nRestart threshold: [gold]"
print __tmp168
label __label82
print "[] K"
op lessThan __tmp169 total_battery min_level
op mul __tmp170 REACTORS_ON -2500
op lessThan __tmp171 battery_change __tmp170
op or __tmp172 __tmp169 __tmp171
jump __label84 equal __tmp172 false
op equal __tmp174 OVERDRIVE false
op add RESETS RESETS __tmp174
set OVERDRIVE true
set REACTORS_ON reactors
op add nextDecommit @time 6000
jump __label79 always 0 0
label __label84
op lessThan __tmp177 battery_level 47500
op lessThan __tmp178 battery_change -100
op or __tmp179 __tmp177 __tmp178
jump __label86 equal __tmp179 false
op add nextDecommit @time 6000
label __label86
jump __label88 lessThanEq @time nextDecommit
jump __label90 equal OVERDRIVE false
set OVERDRIVE false
jump __label91 always 0 0
label __label90
op sub __tmp185 REACTORS_ON 1
op max REACTORS_ON __tmp185 1
set CAN_COMMIT true
label __label91
op add nextDecommit @time 6000
jump __label79 always 0 0
label __label88
jump __label79 greaterThanEq total_battery commit_level
op add REACTORS_ON REACTORS_ON 1
op add COMMITS COMMITS 1
set CAN_COMMIT false
jump __label79 always 0 0
label __label78
sensor __tmp192 switch2 @enabled
jump __label94 equal __tmp192 false
print "\n[salmon]Load adapting not possible.[]"
jump __label95 always 0 0
label __label94
print "\n[gold]Load adapting not active.[]"
label __label95
set REACTORS_ON reactors
set OVERDRIVE true
label __label79
jump __label96 greaterThanEq total_battery 47500
set OUTPUT_2 0
set OUTPUT_3 0
label __label96
jump __label98 notEqual OUTPUT_2 0
jump __label100 lessThanEq total_battery 47500
set OUTPUT_2 1
set OUTPUT_3 1
jump __label101 always 0 0
label __label100
print "\n*** [gold]Surge tower 2 offline[] ***"
label __label101
label __label98
label __label72
label __label41
print "\n"
print STARTUPS
print "-"
print RESETS
print "-"
print COMMITS
printflush message1
control enabled diode1 OUTPUT_1 0 0 0
control enabled diode2 OUTPUT_2 0 0 0
control enabled diode3 OUTPUT_3 0 0 0
control enabled generator1 GENERATOR 0 0 0
control enabled generator2 GENERATOR 0 0 0
op equal startup MODE 1
set reactors 0
set boosts 0
set __tmp202 @links
set n START
jump __label104 greaterThanEq START __tmp202
label __label120
getlink block n
sensor __tmp204 block @type
jump __label106 notEqual __tmp204 @impact-reactor
op add reactors reactors 1
op lessThanEq enabled reactors REACTORS_ON
control enabled block enabled 0 0 0
jump __label105 equal enabled false
sensor __tmp209 block @timescale
op add boosts boosts __tmp209
jump __label105 always 0 0
label __label106
jump __label111 equal __tmp204 @overdrive-projector
jump __label110 notEqual __tmp204 @overdrive-dome
label __label111
control enabled block OVERDRIVE 0 0 0
jump __label105 always 0 0
label __label110
jump __label113 equal __tmp204 @conduit
jump __label113 equal __tmp204 @pulse-conduit
jump __label113 equal __tmp204 @plated-conduit
jump __label113 equal __tmp204 @conveyor
jump __label113 equal __tmp204 @titanium-conveyor
jump __label113 equal __tmp204 @plastanium-conveyor
jump __label112 notEqual __tmp204 @armored-conveyor
label __label113
control enabled block startup 0 0 0
label __label112
label __label105
op add n n 1
jump __label120 lessThan n __tmp202
label __label104
jump __label114 equal cell2 null
write reactors cell2 0
write REACTORS_ON cell2 2
write OVERDRIVE cell2 3
read __tmp213 cell2 1
op add reactors reactors __tmp213
read __tmp215 cell2 4
op add boosts boosts __tmp215
label __label114
op min REACTORS_ON REACTORS_ON reactors
jump __label116 notEqual cell1 null
set STARTUPS 0
set RESETS 0
set COMMITS 0
jump __label15 always 0 0
label __label116
write MODE cell1 0
write OUTPUT_1 cell1 1
write OUTPUT_2 cell1 2
write OUTPUT_3 cell1 3
write REACTORS_ON cell1 4
write OVERDRIVE cell1 5
write GENERATOR cell1 6
write CAN_COMMIT cell1 7
write STARTUPS cell1 8
write RESETS cell1 9
write COMMITS cell1 10
jump __label15 always 0 0
