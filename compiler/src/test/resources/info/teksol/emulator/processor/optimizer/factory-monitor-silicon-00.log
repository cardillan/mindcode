   477 instructions before optimizations.
    48 instructions eliminated by Temp Variables Elimination.
    48 instructions eliminated by Dead Code Elimination (4 iterations).
    26 instructions eliminated by Jump Optimization (4 iterations).
    23 instructions eliminated by Single Step Elimination (3 passes, 7 iterations).
     2 instructions eliminated by Expression Optimization (2 passes, 3 iterations).
     5 instructions eliminated by If Expression Optimization (3 iterations).
    35 instructions eliminated by Data Flow Optimization (3 passes, 10 iterations).
     1 instructions added by Loop Optimization (3 iterations).
     3 loops improved by Loop Optimization.
     2 instructions updated by PropagateJumpTargets.
     1 instructions eliminated by Print Merging.
   290 instructions after optimizations.

Pass 1: speed optimization selection (cost limit 692):
  * Loop Optimization: replicate condition at line 33            cost     1, benefit       25.0, efficiency       25.0 (+1 instructions)

Final code before resolving virtual instructions:

set FROM_INDEX 0
set TO_INDEX 8
set EXPECTED_BOOST 1.5
draw clear 0 0 80 0 0 0
jump __label0 equal bank1 null
set BAR_LENGTH 53
set BAR_SPACE 74
jump __label1 always 0 0
label __label0
set BAR_LENGTH 61
set BAR_SPACE 88
label __label1
set __tmp3 176
jump __label3 equal bank1 null
set __tmp3 156
label __label3
set __tmp5 0
jump __label5 equal FROM_INDEX 0
op mul __tmp6 FROM_INDEX 22
op add __tmp5 4 __tmp6
label __label5
set __tmp9 176
jump __label7 greaterThanEq TO_INDEX 8
op mul __tmp10 TO_INDEX 22
op add __tmp9 4 __tmp10
label __label7
op sub clh __tmp9 __tmp5
set showa null
set lastRate null
set flow_str null
set expected_flow_str null
set icon null
control enabled switch1 0 0 0 0
sensor __tmp13 switch1 @enabled
jump __label10 notEqual __tmp13 0
label __label73
set start @time
print "Silicon Factory Monitor"
set factories 0
draw color 0 0 80 255 0 0
draw rect 0 __tmp5 __tmp3 clh 0 0
draw stroke 2 0 0 0 0 0
set index FROM_INDEX
set n 0
jump __label13 greaterThanEq 0 @links
label __label71
getlink smelter n
sensor __tmp18 smelter @type
jump __label14 notEqual __tmp18 @silicon-crucible
set minimum 31
sensor s smelter @sand
sensor c smelter @coal
sensor p smelter @pyratite
sensor __tmp24 smelter @silicon
op min a __tmp24 30
sensor e smelter @enabled
sensor power smelter @totalPower
sensor boost smelter @timescale
jump __label16 greaterThanEq s 31
set minimum s
set icon @sand
label __label16
jump __label18 greaterThanEq c minimum
set minimum c
set icon @coal
label __label18
jump __label20 greaterThanEq p minimum
set minimum p
set icon @pyratite
label __label20
op greaterThan __tmp35 a 10
op sub __tmp36 31 a
op lessThan __tmp37 __tmp36 minimum
op land showa __tmp35 __tmp37
jump __label22 equal showa false
set icon @silicon
label __label22
op mul __tmp42 index 22
op add y 4 __tmp42
draw color 0 0 80 255 0 0
op sub __tmp45 y 1
draw rect 4 __tmp45 BAR_SPACE 16 0 0
op greaterThan __tmp46 minimum 26
op equal __tmp47 showa 0
op land __tmp48 __tmp46 __tmp47
jump __label24 equal __tmp48 false
set icon @silicon-crucible
label __label24
draw color 255 255 255 255 0 0
jump __label26 equal e false
jump __label28 lessThanEq power 0
op add __tmp54 y 7
draw image 12 __tmp54 icon 16 0 0
jump __label27 always 0 0
label __label28
draw color 255 80 80 255 0 0
op add __tmp55 y 3
draw rect 5 __tmp55 14 8 0 0
draw color 0 0 0 255 0 0
op add __tmp57 y 5
draw rect 7 __tmp57 8 4 0 0
draw rect 17 __tmp55 2 2 0 0
op add __tmp61 y 9
draw rect 17 __tmp61 2 2 0 0
draw color 255 80 80 255 0 0
op add __tmp63 y 6
draw rect 9 __tmp63 2 2 0 0
jump __label27 always 0 0
label __label26
draw color 255 80 80 255 0 0
draw stroke 3 0 0 0 0 0
op add __tmp65 y 12
op add __tmp67 y 2
draw line 7 __tmp65 17 __tmp67 0 0
draw line 7 __tmp67 17 __tmp65 0 0
draw color 0 0 0 255 0 0
draw lineRect 4 __tmp45 16 16 0 0
draw stroke 2 0 0 0 0 0
label __label27
op mul __tmp75 power e
jump __label30 notEqual __tmp75 0
set red 255
set green 0
set blue 0
jump __label31 always 0 0
label __label30
jump __label32 equal showa false
set red 255
set green 0
set blue 255
set minimum a
jump __label33 always 0 0
label __label32
set red 255
op greaterThan __tmp79 minimum 20
op greaterThanEq __tmp80 boost EXPECTED_BOOST
op land __tmp81 __tmp79 __tmp80
jump __label35 equal __tmp81 false
set red 0
label __label35
set green 0
jump __label37 lessThanEq minimum 10
set green 255
label __label37
set blue 0
label __label33
label __label31
jump __label38 lessThanEq boost EXPECTED_BOOST
op max red 192 red
op max green 192 green
op max blue 192 blue
set boost EXPECTED_BOOST
label __label38
op mul __tmp90 BAR_LENGTH boost
op idiv length __tmp90 EXPECTED_BOOST
draw color red green blue 128 0 0
op mul __tmp92 minimum length
op idiv __tmp93 __tmp92 30
draw rect 21 y __tmp93 14 0 0
draw color red green blue 255 0 0
draw lineRect 21 y length 14 0 0
op add index index 1
op add factories factories 1
label __label14
op add n n 1
jump __label71 lessThan n @links
label __label13
set index FROM_INDEX
set n 0
jump __label42 greaterThanEq 0 @links
label __label72
getlink smelter n
sensor __tmp99 smelter @type
jump __label43 notEqual __tmp99 @pyratite-mixer
set minimum 11
sensor s smelter @sand
sensor c smelter @coal
sensor l smelter @lead
sensor a smelter @pyratite
sensor e smelter @enabled
sensor power smelter @totalPower
sensor boost smelter @timescale
jump __label45 greaterThanEq s 11
set minimum s
set icon @sand
label __label45
jump __label47 greaterThanEq c minimum
set minimum c
set icon @coal
label __label47
jump __label49 greaterThanEq l minimum
set minimum l
set icon @lead
label __label49
op add x 5 BAR_SPACE
op mul __tmp117 index 22
op add y 4 __tmp117
draw color 0 0 80 255 0 0
op sub __tmp119 x 1
op sub __tmp120 y 1
draw rect __tmp119 __tmp120 BAR_SPACE 16 0 0
op greaterThan __tmp121 minimum 6
op equal __tmp122 showa 0
op land __tmp123 __tmp121 __tmp122
jump __label51 equal __tmp123 false
set icon @pyratite-mixer
label __label51
draw color 255 255 255 255 0 0
jump __label53 equal e false
jump __label55 lessThanEq power 0
op add __tmp128 x 7
op add __tmp129 y 7
draw image __tmp128 __tmp129 icon 16 0 0
jump __label54 always 0 0
label __label55
draw color 255 80 80 255 0 0
op add __tmp130 y 3
draw rect x __tmp130 14 8 0 0
draw color 0 0 0 255 0 0
op add __tmp131 x 2
op add __tmp132 y 5
draw rect __tmp131 __tmp132 8 4 0 0
op add __tmp133 x 12
draw rect __tmp133 __tmp130 2 2 0 0
op add __tmp136 y 9
draw rect __tmp133 __tmp136 2 2 0 0
draw color 255 80 80 255 0 0
op add __tmp137 x 4
op add __tmp138 y 6
draw rect __tmp137 __tmp138 2 2 0 0
jump __label54 always 0 0
label __label53
draw color 255 80 80 255 0 0
draw stroke 3 0 0 0 0 0
op add __tmp139 x 2
op add __tmp140 y 12
op add __tmp141 x 12
op add __tmp142 y 2
draw line __tmp139 __tmp140 __tmp141 __tmp142 0 0
draw line __tmp139 __tmp142 __tmp141 __tmp140 0 0
draw color 0 0 0 255 0 0
draw lineRect __tmp119 __tmp120 16 16 0 0
draw stroke 2 0 0 0 0 0
label __label54
op add x x 16
op mul __tmp150 power e
jump __label57 notEqual __tmp150 0
set red 255
set green 0
set blue 0
jump __label58 always 0 0
label __label57
set red 255
op greaterThanEq __tmp154 boost EXPECTED_BOOST
op land __tmp155 __tmp121 __tmp154
jump __label60 equal __tmp155 false
set red 0
label __label60
set green 0
jump __label62 lessThanEq minimum 3
set green 255
label __label62
set blue 0
label __label58
jump __label63 lessThanEq boost EXPECTED_BOOST
op max red 192 red
op max green 192 green
op max blue 192 0
set boost EXPECTED_BOOST
label __label63
op mul __tmp164 BAR_LENGTH boost
op idiv length __tmp164 EXPECTED_BOOST
draw color red green blue 128 0 0
op mul __tmp166 minimum length
op idiv __tmp167 __tmp166 10
draw rect x y __tmp167 14 0 0
draw color red green blue 255 0 0
draw lineRect x y length 14 0 0
op add index index 1
label __label43
op add n n 1
jump __label72 lessThan n @links
label __label42
jump __label65 equal bank1 null
jump __label67 notEqual FROM_INDEX 0
read rate bank1 511
jump __label69 equal lastRate rate
op mul __tmp177 EXPECTED_BOOST factories
op div expected_flow __tmp177 11.25
op idiv expected_flow_str expected_flow 0.0002777777777777778
set lastRate rate
draw color 0 0 80 255 0 0
draw rect 156 0 16 176 0 0
draw color 255 128 128 255 0 0
draw rect 164 4 8 84 0 0
draw color 128 255 128 255 0 0
draw rect 164 89 8 84 0 0
draw stroke 1 0 0 0 0 0
draw color 255 0 0 255 0 0
draw lineRect 164 4 8 84 0 0
draw color 0 255 0 255 0 0
draw lineRect 164 89 8 84 0 0
draw color 0 0 80 255 0 0
draw rect 164 4 2 170 0 0
op sub __tmp181 rate expected_flow
op mul __tmp182 84 __tmp181
op div __tmp183 __tmp182 expected_flow
op add pos 88 __tmp183
op max __tmp185 pos 4
op min pos __tmp185 170
op add pos1 pos 7
op sub pos2 pos 7
draw color 255 255 16 255 0 0
draw triangle 156 pos1 164 pos 156 pos2
op idiv flow_str rate 0.0002777777777777778
label __label69
label __label67
print "\nNominal production: "
print expected_flow_str
print "/min\nActual production: "
print flow_str
print "/min"
label __label65
drawflush display1
op sub __tmp191 @time start
op floor __tmp192 __tmp191 0
print "\nUpdate time: "
print __tmp192
print " ms"
printflush message1
sensor __tmp13 switch1 @enabled
jump __label73 equal __tmp13 0
label __label10
