   297 instructions before optimizations.
    41 instructions eliminated by Temp Variables Elimination (2 passes, 7 iterations).
    32 instructions eliminated by Dead Code Elimination (5 iterations).
    15 instructions eliminated by Condition Optimization (6 iterations).
    11 instructions eliminated by Single Step Elimination (2 passes, 7 iterations).
     2 instructions eliminated by Expression Optimization (3 iterations).
    12 instructions eliminated by Boolean Optimization (6 iterations).
       5 fully-evaluated expressions optimized using selects.
     1 instructions eliminated by Data Flow Optimization (2 passes, 7 iterations).
     1 instructions added by Loop Rotation (3 iterations).
       2 loop conditions were partially rotated.
     2 instructions updated by Jump Threading.
    10 instructions eliminated by Print Merging.
   174 instructions after optimizations.

Pass 1: speed optimization selection (cost limit 814):
  * Full loop rotation at line 26:1                              size    +1, benefit       26.0, efficiency     26.000 (+1 instructions)

Modifications by Initial phase, Dead Code Elimination, iteration 1 (-26 instructions):
 
     9 jump *label0 equal *tmp4 false
    10 set .BAR_LENGTH 53
    11 set .BAR_SPACE 74
-    * set *tmp5 .BAR_SPACE
    12 jump *label1 always
    13 label *label0
    14 set .BAR_LENGTH 61
    15 set .BAR_SPACE 88
-    * set *tmp5 .BAR_SPACE
    16 label *label1
    17 set :lastRate null
    18 set :icon :lastRate
 
    71 draw rect 0 0 156 176
    72 set *tmp17 null
    73 label *label10
-    * set *tmp13 *tmp17
    74 jump *label8 always
    75 label *label7
-    * set *tmp13 null
    76 label *label8
    77 print "\n"
    78 print "Nominal production: "
 
    84 print :flow_str
    85 print "/"
    86 print "min"
-    * set *tmp11 null
    87 jump *label6 always
    88 label *label5
-    * set *tmp11 null
    89 label *label6
    90 set *tmp28 @time
    91 set :start *tmp28
 
   121 jump *label16 equal *tmp42 false
   122 set :minimum :l
   123 set :icon @lead
-    * set *tmp43 :icon
   124 jump *label17 always
   125 label *label16
-    * set *tmp43 null
   126 label *label17
   127 op lessThan *tmp44 :s :minimum
   128 jump *label18 equal *tmp44 false
   129 set :minimum :s
   130 set :icon @silicon
-    * set *tmp45 :icon
   131 jump *label19 always
   132 label *label18
-    * set *tmp45 null
   133 label *label19
   134 op lessThan *tmp46 :c :minimum
   135 jump *label20 equal *tmp46 false
   136 set :minimum :c
   137 set :icon @copper
-    * set *tmp47 :icon
   138 jump *label21 always
   139 label *label20
-    * set *tmp47 null
   140 label *label21
   141 op lessThan *tmp48 :t :minimum
   142 jump *label22 equal *tmp48 false
   143 set :minimum :t
   144 set :icon @titanium
-    * set *tmp49 :icon
   145 jump *label23 always
   146 label *label22
-    * set *tmp49 null
   147 label *label23
   148 op greaterThan *tmp50 :a 5
   149 op sub *tmp51 21 :a
 
   152 set :showa *tmp53
   153 jump *label24 equal :showa false
   154 set :icon @surge-alloy
-    * set *tmp54 :icon
   155 jump *label25 always
   156 label *label24
-    * set *tmp54 null
   157 label *label25
   158 op mod *tmp55 :index 2
   159 set :column *tmp55
 
   176 op land *tmp65 *tmp63 *tmp64
   177 jump *label26 equal *tmp65 false
   178 set :icon @surge-smelter
-    * set *tmp66 :icon
   179 jump *label27 always
   180 label *label26
-    * set *tmp66 null
   181 label *label27
   182 draw color 255 255 255 255
   183 jump *label28 equal :e false
 
   208 draw rect *tmp77 *tmp78 2 2
   209 set *tmp69 null
   210 label *label31
-    * set *tmp67 *tmp69
   211 jump *label29 always
   212 label *label28
   213 op add *tmp79 :x 2
 
   225 draw color 0 0 0 255
   226 draw lineRect :xm1 :ym1 16 16
   227 draw stroke 2
-    * set *tmp67 null
   228 label *label29
   229 op add *tmp83 :x 16
   230 set :x *tmp83
 
   234 set :red 255
   235 set :green 0
   236 set :blue 0
-    * set *tmp86 :blue
   237 jump *label33 always
   238 label *label32
   239 jump *label34 equal :showa false
 
   265 set :blue 0
   266 set *tmp87 :blue
   267 label *label35
-    * set *tmp86 *tmp87
   268 label *label33
   269 op greaterThan *tmp94 :boost EXPECTED_BOOST
   270 jump *label40 equal *tmp94 false
 
   275 op max *tmp98 192 :blue
   276 set :blue *tmp98
   277 set :boost EXPECTED_BOOST
-    * set *tmp95 :boost
   278 jump *label41 always
   279 label *label40
-    * set *tmp95 null
   280 label *label41
   281 op mul *tmp99 .BAR_LENGTH :boost
   282 op idiv *tmp100 *tmp99 EXPECTED_BOOST
 
   289 draw lineRect :x :y :length 14
   290 op add *tmp103 :index 1
   291 set :index *tmp103
-    * set *tmp33 :index
   292 jump *label15 always
   293 label *label14
-    * set *tmp33 null
   294 label *label15
   295 label *label12
   296 op add *tmp104 :n 1

Modifications by Initial phase, Dead Code Elimination, iteration 2 (-6 instructions):
 
    64 op mul *tmp26 3600 :rate
    65 op floor *tmp27 *tmp26
    66 set :flow_str *tmp27
-    * set *tmp17 :flow_str
    67 jump *label10 always
    68 label *label9
    69 draw color 0 0 80 255
    70 draw rect 0 0 156 176
-    * set *tmp17 null
    71 label *label10
    72 jump *label8 always
    73 label *label7
 
   184 op add *tmp70 :x 7
   185 op add *tmp71 :y 7
   186 draw image *tmp70 *tmp71 :icon 16 0
-    * set *tmp69 null
   187 jump *label31 always
   188 label *label30
   189 op add *tmp72 :x 12
 
   203 op add *tmp77 :x 4
   204 op add *tmp78 :y 6
   205 draw rect *tmp77 *tmp78 2 2
-    * set *tmp69 null
   206 label *label31
   207 jump *label29 always
   208 label *label28
 
   237 set :green 0
   238 set :blue 255
   239 set :minimum :a
-    * set *tmp87 :minimum
   240 jump *label35 always
   241 label *label34
   242 op greaterThan *tmp88 :minimum 14
 
   258 label *label39
   259 set :green *tmp93
   260 set :blue 0
-    * set *tmp87 :blue
   261 label *label35
   262 label *label33
   263 op greaterThan *tmp94 :boost EXPECTED_BOOST

Modifications by Initial phase, Temp Variables Elimination, iteration 1 (-39 instructions):
     0 set FROM_INDEX 0
     1 set EXPECTED_BOOST 1.5
     2 op mul *tmp0 EXPECTED_BOOST 16
-    * op div *tmp1 *tmp0 75
-    * set .EXPECTED_FLOW *tmp1
+    3 op div .EXPECTED_FLOW *tmp0 75
     4 op mul *tmp2 .EXPECTED_FLOW 3600
-    * op floor *tmp3 *tmp2
-    * set .EXPECTED_FLOW_STR *tmp3
+    5 op floor .EXPECTED_FLOW_STR *tmp2
     6 op notEqual *tmp4 bank1 null
     7 jump *label0 equal *tmp4 false
     8 set .BAR_LENGTH 53
 
    15 set :lastRate null
    16 set :icon :lastRate
    17 set :flow_str :icon
-    * set *tmp6 switch1
-    * control enabled *tmp6 0
+   18 control enabled switch1 0
    19 label *label2
    20 sensor *tmp8 switch1 @enabled
    21 op equal *tmp9 *tmp8 0
 
    25 jump *label5 equal *tmp10 false
    26 op equal *tmp12 FROM_INDEX 0
    27 jump *label7 equal *tmp12 false
-    * read *tmp15 bank1 511
-    * set :rate *tmp15
+   28 read :rate bank1 511
    29 op notEqual *tmp16 :lastRate :rate
    30 jump *label9 equal *tmp16 false
    31 draw clear 0 0 80
 
    46 op sub *tmp18 :rate .EXPECTED_FLOW
    47 op mul *tmp19 84 *tmp18
    48 op div *tmp20 *tmp19 .EXPECTED_FLOW
-    * op add *tmp21 88 *tmp20
-    * set :pos *tmp21
+   49 op add :pos 88 *tmp20
    50 op max *tmp22 :pos 4
-    * op min *tmp23 *tmp22 170
-    * set :pos *tmp23
-    * op add *tmp24 :pos 7
-    * set :pos1 *tmp24
-    * op sub *tmp25 :pos 7
-    * set :pos2 *tmp25
+   51 op min :pos *tmp22 170
+   52 op add :pos1 :pos 7
+   53 op sub :pos2 :pos 7
    54 draw color 255 255 16 255
    55 draw triangle 156 :pos1 164 :pos 156 :pos2
    56 op mul *tmp26 3600 :rate
-    * op floor *tmp27 *tmp26
-    * set :flow_str *tmp27
+   57 op floor :flow_str *tmp26
    58 jump *label10 always
    59 label *label9
    60 draw color 0 0 80 255
 
    76 jump *label6 always
    77 label *label5
    78 label *label6
-    * set *tmp28 @time
-    * set :start *tmp28
+   79 set :start @time
    80 draw stroke 2
    81 set :index FROM_INDEX
    82 set :n 0
    83 label *label11
    84 op lessThan *tmp29 :n @links
    85 jump *label13 equal *tmp29 false
-    * getlink *tmp30 :n
-    * set :smelter *tmp30
+   86 getlink :smelter :n
    87 sensor *tmp31 :smelter @type
    88 op equal *tmp32 *tmp31 @surge-smelter
    89 jump *label14 equal *tmp32 false
    90 set :minimum 21
-    * sensor *tmp34 :smelter @titanium
-    * set :t *tmp34
-    * sensor *tmp35 :smelter @copper
-    * set :c *tmp35
-    * sensor *tmp36 :smelter @lead
-    * set :l *tmp36
-    * sensor *tmp37 :smelter @silicon
-    * set :s *tmp37
-    * sensor *tmp38 :smelter @surge-alloy
-    * set :a *tmp38
-    * sensor *tmp39 :smelter @enabled
-    * set :e *tmp39
-    * sensor *tmp40 :smelter @totalPower
-    * set :power *tmp40
-    * sensor *tmp41 :smelter @timescale
-    * set :boost *tmp41
+   91 sensor :t :smelter @titanium
+   92 sensor :c :smelter @copper
+   93 sensor :l :smelter @lead
+   94 sensor :s :smelter @silicon
+   95 sensor :a :smelter @surge-alloy
+   96 sensor :e :smelter @enabled
+   97 sensor :power :smelter @totalPower
+   98 sensor :boost :smelter @timescale
    99 op lessThan *tmp42 :l :minimum
   100 jump *label16 equal *tmp42 false
   101 set :minimum :l
 
   127 op greaterThan *tmp50 :a 5
   128 op sub *tmp51 21 :a
   129 op lessThan *tmp52 *tmp51 :minimum
-    * op land *tmp53 *tmp50 *tmp52
-    * set :showa *tmp53
+  130 op land :showa *tmp50 *tmp52
   131 jump *label24 equal :showa false
   132 set :icon @surge-alloy
   133 jump *label25 always
   134 label *label24
   135 label *label25
-    * op mod *tmp55 :index 2
-    * set :column *tmp55
-    * op idiv *tmp56 :index 2
-    * set :row *tmp56
+  136 op mod :column :index 2
+  137 op idiv :row :index 2
   138 op mul *tmp57 :column .BAR_SPACE
-    * op add *tmp58 5 *tmp57
-    * set :x *tmp58
+  139 op add :x 5 *tmp57
   140 op mul *tmp59 :row 22
-    * op add *tmp60 4 *tmp59
-    * set :y *tmp60
-    * op sub *tmp61 :x 1
-    * set :xm1 *tmp61
-    * op sub *tmp62 :y 1
-    * set :ym1 *tmp62
+  141 op add :y 4 *tmp59
+  142 op sub :xm1 :x 1
+  143 op sub :ym1 :y 1
   144 draw color 0 0 80 255
   145 draw rect :xm1 :ym1 .BAR_SPACE 16
   146 op greaterThan *tmp63 :minimum 16
 
   160 draw image *tmp70 *tmp71 :icon 16 0
   161 jump *label31 always
   162 label *label30
-    * op add *tmp72 :x 12
-    * set :x12 *tmp72
-    * op add *tmp73 :y 3
-    * set :y3 *tmp73
+  163 op add :x12 :x 12
+  164 op add :y3 :y 3
   165 draw color 255 80 80 255
   166 draw rect :x :y3 14 8
   167 draw color 0 0 0 255
 
   178 label *label31
   179 jump *label29 always
   180 label *label28
-    * op add *tmp79 :x 2
-    * set :x2 *tmp79
-    * op add *tmp80 :y 2
-    * set :y2 *tmp80
-    * op add *tmp81 :x 12
-    * set :x12 *tmp81
-    * op add *tmp82 :y 12
-    * set :y12 *tmp82
+  181 op add :x2 :x 2
+  182 op add :y2 :y 2
+  183 op add :x12 :x 12
+  184 op add :y12 :y 12
   185 draw color 255 80 80 255
   186 draw stroke 3
   187 draw line :x2 :y12 :x12 :y2
 
   190 draw lineRect :xm1 :ym1 16 16
   191 draw stroke 2
   192 label *label29
-    * op add *tmp83 :x 16
-    * set :x *tmp83
+  193 op add :x :x 16
   194 op mul *tmp84 :power :e
   195 op equal *tmp85 *tmp84 0
   196 jump *label32 equal *tmp85 false
 
   229 label *label33
   230 op greaterThan *tmp94 :boost EXPECTED_BOOST
   231 jump *label40 equal *tmp94 false
-    * op max *tmp96 192 :red
-    * set :red *tmp96
-    * op max *tmp97 192 :green
-    * set :green *tmp97
-    * op max *tmp98 192 :blue
-    * set :blue *tmp98
+  232 op max :red 192 :red
+  233 op max :green 192 :green
+  234 op max :blue 192 :blue
   235 set :boost EXPECTED_BOOST
   236 jump *label41 always
   237 label *label40
   238 label *label41
   239 op mul *tmp99 .BAR_LENGTH :boost
-    * op idiv *tmp100 *tmp99 EXPECTED_BOOST
-    * set :length *tmp100
+  240 op idiv :length *tmp99 EXPECTED_BOOST
   241 draw color :red :green :blue 128
   242 op mul *tmp101 :minimum :length
   243 op idiv *tmp102 *tmp101 20
   244 draw rect :x :y *tmp102 14
   245 draw color :red :green :blue 255
   246 draw lineRect :x :y :length 14
-    * op add *tmp103 :index 1
-    * set :index *tmp103
+  247 op add :index :index 1
   248 jump *label15 always
   249 label *label14
   250 label *label15
   251 label *label12
-    * op add *tmp104 :n 1
-    * set :n *tmp104
+  252 op add :n :n 1
   253 jump *label11 always
   254 label *label13
   255 drawflush display1

Modifications by Iterated phase, Condition Optimization, pass 1, iteration 1 (-15 instructions):
 
     3 op div .EXPECTED_FLOW *tmp0 75
     4 op mul *tmp2 .EXPECTED_FLOW 3600
     5 op floor .EXPECTED_FLOW_STR *tmp2
-    * op notEqual *tmp4 bank1 null
-    * jump *label0 equal *tmp4 false
+    6 jump *label0 equal bank1 null
     7 set .BAR_LENGTH 53
     8 set .BAR_SPACE 74
     9 jump *label1 always
 
    17 control enabled switch1 0
    18 label *label2
    19 sensor *tmp8 switch1 @enabled
-    * op equal *tmp9 *tmp8 0
-    * jump *label4 equal *tmp9 false
+   20 jump *label4 notEqual *tmp8 0
    21 print "Surge Alloy Factory Monitor"
-    * op notEqual *tmp10 bank1 null
-    * jump *label5 equal *tmp10 false
-    * op equal *tmp12 FROM_INDEX 0
-    * jump *label7 equal *tmp12 false
+   22 jump *label5 equal bank1 null
+   23 jump *label7 notEqual FROM_INDEX 0
    24 read :rate bank1 511
-    * op notEqual *tmp16 :lastRate :rate
-    * jump *label9 equal *tmp16 false
+   25 jump *label9 equal :lastRate :rate
    26 draw clear 0 0 80
    27 set :lastRate :rate
    28 draw color 0 0 80 255
 
    76 set :index FROM_INDEX
    77 set :n 0
    78 label *label11
-    * op lessThan *tmp29 :n @links
-    * jump *label13 equal *tmp29 false
+   79 jump *label13 greaterThanEq :n @links
    80 getlink :smelter :n
    81 sensor *tmp31 :smelter @type
-    * op equal *tmp32 *tmp31 @surge-smelter
-    * jump *label14 equal *tmp32 false
+   82 jump *label14 notEqual *tmp31 @surge-smelter
    83 set :minimum 21
    84 sensor :t :smelter @titanium
    85 sensor :c :smelter @copper
 
    89 sensor :e :smelter @enabled
    90 sensor :power :smelter @totalPower
    91 sensor :boost :smelter @timescale
-    * op lessThan *tmp42 :l :minimum
-    * jump *label16 equal *tmp42 false
+   92 jump *label16 greaterThanEq :l :minimum
    93 set :minimum :l
    94 set :icon @lead
    95 jump *label17 always
    96 label *label16
    97 label *label17
-    * op lessThan *tmp44 :s :minimum
-    * jump *label18 equal *tmp44 false
+   98 jump *label18 greaterThanEq :s :minimum
    99 set :minimum :s
   100 set :icon @silicon
   101 jump *label19 always
   102 label *label18
   103 label *label19
-    * op lessThan *tmp46 :c :minimum
-    * jump *label20 equal *tmp46 false
+  104 jump *label20 greaterThanEq :c :minimum
   105 set :minimum :c
   106 set :icon @copper
   107 jump *label21 always
   108 label *label20
   109 label *label21
-    * op lessThan *tmp48 :t :minimum
-    * jump *label22 equal *tmp48 false
+  110 jump *label22 greaterThanEq :t :minimum
   111 set :minimum :t
   112 set :icon @titanium
   113 jump *label23 always
 
   142 label *label27
   143 draw color 255 255 255 255
   144 jump *label28 equal :e false
-    * op greaterThan *tmp68 :power 0
-    * jump *label30 equal *tmp68 false
+  145 jump *label30 lessThanEq :power 0
   146 op add *tmp70 :x 7
   147 op add *tmp71 :y 7
   148 draw image *tmp70 *tmp71 :icon 16 0
 
   180 label *label29
   181 op add :x :x 16
   182 op mul *tmp84 :power :e
-    * op equal *tmp85 *tmp84 0
-    * jump *label32 equal *tmp85 false
+  183 jump *label32 notEqual *tmp84 0
   184 set :red 255
   185 set :green 0
   186 set :blue 0
 
   203 set *tmp91 255
   204 label *label37
   205 set :red *tmp91
-    * op greaterThan *tmp92 :minimum 7
-    * jump *label38 equal *tmp92 false
+  206 jump *label38 lessThanEq :minimum 7
   207 set *tmp93 255
   208 jump *label39 always
   209 label *label38
 
   213 set :blue 0
   214 label *label35
   215 label *label33
-    * op greaterThan *tmp94 :boost EXPECTED_BOOST
-    * jump *label40 equal *tmp94 false
+  216 jump *label40 lessThanEq :boost EXPECTED_BOOST
   217 op max :red 192 :red
   218 op max :green 192 :green
   219 op max :blue 192 :blue

Modifications by Iterated phase, Single Step Elimination, pass 1, iteration 1 (-10 instructions):
 
    55 draw color 0 0 80 255
    56 draw rect 0 0 156 176
    57 label *label10
-    * jump *label8 always
    58 label *label7
    59 label *label8
    60 print "\n"
 
    67 print :flow_str
    68 print "/"
    69 print "min"
-    * jump *label6 always
    70 label *label5
    71 label *label6
    72 set :start @time
 
    90 jump *label16 greaterThanEq :l :minimum
    91 set :minimum :l
    92 set :icon @lead
-    * jump *label17 always
    93 label *label16
    94 label *label17
    95 jump *label18 greaterThanEq :s :minimum
    96 set :minimum :s
    97 set :icon @silicon
-    * jump *label19 always
    98 label *label18
    99 label *label19
   100 jump *label20 greaterThanEq :c :minimum
   101 set :minimum :c
   102 set :icon @copper
-    * jump *label21 always
   103 label *label20
   104 label *label21
   105 jump *label22 greaterThanEq :t :minimum
   106 set :minimum :t
   107 set :icon @titanium
-    * jump *label23 always
   108 label *label22
   109 label *label23
   110 op greaterThan *tmp50 :a 5
 
   113 op land :showa *tmp50 *tmp52
   114 jump *label24 equal :showa false
   115 set :icon @surge-alloy
-    * jump *label25 always
   116 label *label24
   117 label *label25
   118 op mod :column :index 2
 
   130 op land *tmp65 *tmp63 *tmp64
   131 jump *label26 equal *tmp65 false
   132 set :icon @surge-smelter
-    * jump *label27 always
   133 label *label26
   134 label *label27
   135 draw color 255 255 255 255
 
   210 op max :green 192 :green
   211 op max :blue 192 :blue
   212 set :boost EXPECTED_BOOST
-    * jump *label41 always
   213 label *label40
   214 label *label41
   215 op mul *tmp99 .BAR_LENGTH :boost
 
   221 draw color :red :green :blue 255
   222 draw lineRect :x :y :length 14
   223 op add :index :index 1
-    * jump *label15 always
   224 label *label14
   225 label *label15
   226 label *label12

Modifications by Iterated phase, Expression Optimization, pass 1, iteration 1 (-2 instructions):
 
     1 set EXPECTED_BOOST 1.5
     2 op mul *tmp0 EXPECTED_BOOST 16
     3 op div .EXPECTED_FLOW *tmp0 75
-    * op mul *tmp2 .EXPECTED_FLOW 3600
-    * op floor .EXPECTED_FLOW_STR *tmp2
+    4 op idiv .EXPECTED_FLOW_STR .EXPECTED_FLOW 0.0002777777777777778
     5 jump *label0 equal bank1 null
     6 set .BAR_LENGTH 53
     7 set .BAR_SPACE 74
 
    47 op sub :pos2 :pos 7
    48 draw color 255 255 16 255
    49 draw triangle 156 :pos1 164 :pos 156 :pos2
-    * op mul *tmp26 3600 :rate
-    * op floor :flow_str *tmp26
+   50 op idiv :flow_str :rate 0.0002777777777777778
    51 jump *label10 always
    52 label *label9
    53 draw color 0 0 80 255

Modifications by Iterated phase, Data Flow Optimization, pass 1, iteration 1:
     0 set FROM_INDEX 0
     1 set EXPECTED_BOOST 1.5
     2 op mul *tmp0 EXPECTED_BOOST 16
-    * op div .EXPECTED_FLOW *tmp0 75
+    3 op div .EXPECTED_FLOW EXPECTED_BOOST 4.6875
     4 op idiv .EXPECTED_FLOW_STR .EXPECTED_FLOW 0.0002777777777777778
     5 jump *label0 equal bank1 null
     6 set .BAR_LENGTH 53
 
    11 set .BAR_SPACE 88
    12 label *label1
    13 set :lastRate null
-    * set :icon :lastRate
-    * set :flow_str :icon
+   14 set :icon null
+   15 set :flow_str :lastRate
    16 control enabled switch1 0
    17 label *label2
    18 sensor *tmp8 switch1 @enabled
 
    85 sensor :e :smelter @enabled
    86 sensor :power :smelter @totalPower
    87 sensor :boost :smelter @timescale
-    * jump *label16 greaterThanEq :l :minimum
+   88 jump *label16 greaterThanEq :l 21
    89 set :minimum :l
    90 set :icon @lead
    91 label *label16
 
   168 draw lineRect :xm1 :ym1 16 16
   169 draw stroke 2
   170 label *label29
-    * op add :x :x 16
+  171 op add :x *tmp57 21
   172 op mul *tmp84 :power :e
   173 jump *label32 notEqual *tmp84 0
   174 set :red 255

Modifications by Iterated phase, Data Flow Optimization, pass 1, iteration 2 (-1 instructions):
     0 set FROM_INDEX 0
     1 set EXPECTED_BOOST 1.5
-    * op mul *tmp0 EXPECTED_BOOST 16
     2 op div .EXPECTED_FLOW EXPECTED_BOOST 4.6875
     3 op idiv .EXPECTED_FLOW_STR .EXPECTED_FLOW 0.0002777777777777778
     4 jump *label0 equal bank1 null
 
    11 label *label1
    12 set :lastRate null
    13 set :icon null
-    * set :flow_str :lastRate
+   14 set :flow_str null
    15 control enabled switch1 0
    16 label *label2
    17 sensor *tmp8 switch1 @enabled

Modifications by Iterated phase, Loop Rotation, pass 1, iteration 1:
 
    72 set :n 0
    73 label *label11
    74 jump *label13 greaterThanEq :n @links
+   75 label *label42
    76 getlink :smelter :n
    77 sensor *tmp31 :smelter @type
    78 jump *label14 notEqual *tmp31 @surge-smelter
 
   223 label *label15
   224 label *label12
   225 op add :n :n 1
-    * jump *label11 always
+  226 jump *label42 lessThan :n @links
   227 label *label13
   228 drawflush display1
   229 op sub *tmp105 @time :start

Modifications by Iterated phase, Boolean Optimization, pass 1, iteration 1 (-12 instructions):
 
     1 set EXPECTED_BOOST 1.5
     2 op div .EXPECTED_FLOW EXPECTED_BOOST 4.6875
     3 op idiv .EXPECTED_FLOW_STR .EXPECTED_FLOW 0.0002777777777777778
-    * jump *label0 equal bank1 null
-    * set .BAR_LENGTH 53
-    * set .BAR_SPACE 74
-    * jump *label1 always
-    * label *label0
-    * set .BAR_LENGTH 61
-    * set .BAR_SPACE 88
-    * label *label1
+    4 select .BAR_LENGTH notEqual bank1 null 53 61
+    5 select .BAR_SPACE notEqual bank1 null 74 88
     6 set :lastRate null
     7 set :icon null
     8 set :flow_str null
 
   103 op sub *tmp51 21 :a
   104 op lessThan *tmp52 *tmp51 :minimum
   105 op land :showa *tmp50 *tmp52
-    * jump *label24 equal :showa false
-    * set :icon @surge-alloy
-    * label *label24
-    * label *label25
+  106 select :icon notEqual :showa false @surge-alloy :icon
   107 op mod :column :index 2
   108 op idiv :row :index 2
   109 op mul *tmp57 :column .BAR_SPACE
 
   114 op sub :ym1 :y 1
   115 draw color 0 0 80 255
   116 draw rect :xm1 :ym1 .BAR_SPACE 16
-    * op greaterThan *tmp63 :minimum 16
-    * op equal *tmp64 :showa 0
-    * op land *tmp65 *tmp63 *tmp64
-    * jump *label26 equal *tmp65 false
-    * set :icon @surge-smelter
-    * label *label26
-    * label *label27
+  117 op greaterThan *tmp63 :minimum 16
+  118 op equal *tmp64 :showa 0
+  119 op land *tmp65 *tmp63 *tmp64
+  120 select :icon notEqual *tmp65 false @surge-smelter :icon
   121 draw color 255 255 255 255
   122 jump *label28 equal :e false
   123 jump *label30 lessThanEq :power 0
 
   171 set :minimum :a
   172 jump *label35 always
   173 label *label34
-    * op greaterThan *tmp88 :minimum 14
-    * op greaterThanEq *tmp89 :boost EXPECTED_BOOST
-    * op land *tmp90 *tmp88 *tmp89
-    * jump *label36 equal *tmp90 false
-    * set *tmp91 0
-    * jump *label37 always
-    * label *label36
-    * set *tmp91 255
-    * label *label37
+  174 op greaterThan *tmp88 :minimum 14
+  175 op greaterThanEq *tmp89 :boost EXPECTED_BOOST
+  176 op land *tmp90 *tmp88 *tmp89
+  177 select *tmp91 notEqual *tmp90 false 0 255
   178 set :red *tmp91
-    * jump *label38 lessThanEq :minimum 7
-    * set *tmp93 255
-    * jump *label39 always
-    * label *label38
-    * set *tmp93 0
-    * label *label39
+  179 select *tmp93 greaterThan :minimum 7 255 0
   180 set :green *tmp93
   181 set :blue 0
   182 label *label35

Modifications by Full loop rotation at line 26:1 (+1 instructions):
 
    10 label *label2
    11 sensor *tmp8 switch1 @enabled
    12 jump *label4 notEqual *tmp8 0
+   13 label *label43
    14 print "Surge Alloy Factory Monitor"
    15 jump *label5 equal bank1 null
    16 jump *label7 notEqual FROM_INDEX 0
 
   214 print "ms"
   215 printflush message1
   216 label *label3
-    * jump *label2 always
+  217 sensor *tmp8 switch1 @enabled
+  218 jump *label43 equal *tmp8 0
   219 label *label4
   220 end

Modifications by Iterated phase, Data Flow Optimization, pass 1, iteration 1:
 
    66 set :index FROM_INDEX
    67 set :n 0
    68 label *label11
-    * jump *label13 greaterThanEq :n @links
+   69 jump *label13 greaterThanEq 0 @links
    70 label *label42
    71 getlink :smelter :n
    72 sensor *tmp31 :smelter @type

Modifications by Iterated phase, Temp Variables Elimination, pass 2, iteration 1 (-2 instructions):
 
   175 op greaterThan *tmp88 :minimum 14
   176 op greaterThanEq *tmp89 :boost EXPECTED_BOOST
   177 op land *tmp90 *tmp88 *tmp89
-    * select *tmp91 notEqual *tmp90 false 0 255
-    * set :red *tmp91
-    * select *tmp93 greaterThan :minimum 7 255 0
-    * set :green *tmp93
+  178 select :red notEqual *tmp90 false 0 255
+  179 select :green greaterThan :minimum 7 255 0
   180 set :blue 0
   181 label *label35
   182 label *label33

Modifications by Jumps phase, Jump Threading, pass 4, iteration 1:
+    0 label __start__
     1 set FROM_INDEX 0
     2 set EXPECTED_BOOST 1.5
     3 op div .EXPECTED_FLOW EXPECTED_BOOST 4.6875
 
     9 set :flow_str null
    10 control enabled switch1 0
    11 sensor *tmp8 switch1 @enabled
-    * jump *label4 notEqual *tmp8 0
+   12 jump __start__ notEqual *tmp8 0
    13 label *label43
    14 print "Surge Alloy Factory Monitor"
    15 jump *label5 equal bank1 null
 
   118 op add *tmp70 :x 7
   119 op add *tmp71 :y 7
   120 draw image *tmp70 *tmp71 :icon 16 0
-    * jump *label31 always
+  121 jump *label29 always
   122 label *label30
   123 op add :x12 :x 12
   124 op add :y3 :y 3

Modifications by Jumps phase, Single Step Elimination, pass 4, iteration 1 (-1 instructions):
 
   202 printflush message1
   203 sensor *tmp8 switch1 @enabled
   204 jump *label43 equal *tmp8 0
-    * end

Modifications by Final phase, Print Merging, iteration 1 (-10 instructions):
 
    48 draw rect 0 0 156 176
    49 label *label10
    50 label *label7
-    * print "\n"
-    * print "Nominal production: "
-    * print .EXPECTED_FLOW_STR
-    * print "/"
-    * print "min"
-    * print "\n"
-    * print "Actual production: "
-    * print :flow_str
-    * print "/"
-    * print "min"
+   51 print "\nNominal production: {0}/min\nActual production: {0}/min"
+   52 format .EXPECTED_FLOW_STR
+   53 format :flow_str
    54 label *label5
    55 set :start @time
    56 draw stroke 2
 
   187 drawflush display1
   188 op sub *tmp105 @time :start
   189 op floor *tmp106 *tmp105
-    * print "\n"
-    * print "Update time: "
-    * print *tmp106
-    * print " "
-    * print "ms"
+  190 print "\nUpdate time: {0} ms"
+  191 format *tmp106
   192 printflush message1
   193 sensor *tmp8 switch1 @enabled
   194 jump *label43 equal *tmp8 0

Final code before resolving virtual instructions:

label __start__
set FROM_INDEX 0
set EXPECTED_BOOST 1.5
op div .EXPECTED_FLOW EXPECTED_BOOST 4.6875
op idiv .EXPECTED_FLOW_STR .EXPECTED_FLOW 0.0002777777777777778
select .BAR_LENGTH notEqual bank1 null 53 61
select .BAR_SPACE notEqual bank1 null 74 88
set :lastRate null
set :icon null
set :flow_str null
control enabled switch1 0
sensor *tmp8 switch1 @enabled
jump __start__ notEqual *tmp8 0
label *label43
print "Surge Alloy Factory Monitor"
jump *label5 equal bank1 null
jump *label7 notEqual FROM_INDEX 0
read :rate bank1 511
jump *label9 equal :lastRate :rate
draw clear 0 0 80
set :lastRate :rate
draw color 0 0 80 255
draw rect 156 0 16 176
draw color 255 128 128 255
draw rect 164 4 8 84
draw color 128 255 128 255
draw rect 164 89 8 84
draw stroke 1
draw color 255 0 0 255
draw lineRect 164 4 8 84
draw color 0 255 0 255
draw lineRect 164 89 8 84
draw color 0 0 80 255
draw rect 164 4 2 170
op sub *tmp18 :rate .EXPECTED_FLOW
op mul *tmp19 84 *tmp18
op div *tmp20 *tmp19 .EXPECTED_FLOW
op add :pos 88 *tmp20
op max *tmp22 :pos 4
op min :pos *tmp22 170
op add :pos1 :pos 7
op sub :pos2 :pos 7
draw color 255 255 16 255
draw triangle 156 :pos1 164 :pos 156 :pos2
op idiv :flow_str :rate 0.0002777777777777778
jump *label10 always
label *label9
draw color 0 0 80 255
draw rect 0 0 156 176
label *label10
label *label7
print "\nNominal production: {0}/min\nActual production: {0}/min"
format .EXPECTED_FLOW_STR
format :flow_str
label *label5
set :start @time
draw stroke 2
set :index FROM_INDEX
set :n 0
jump *label13 greaterThanEq 0 @links
label *label42
getlink :smelter :n
sensor *tmp31 :smelter @type
jump *label14 notEqual *tmp31 @surge-smelter
set :minimum 21
sensor :t :smelter @titanium
sensor :c :smelter @copper
sensor :l :smelter @lead
sensor :s :smelter @silicon
sensor :a :smelter @surge-alloy
sensor :e :smelter @enabled
sensor :power :smelter @totalPower
sensor :boost :smelter @timescale
jump *label16 greaterThanEq :l 21
set :minimum :l
set :icon @lead
label *label16
jump *label18 greaterThanEq :s :minimum
set :minimum :s
set :icon @silicon
label *label18
jump *label20 greaterThanEq :c :minimum
set :minimum :c
set :icon @copper
label *label20
jump *label22 greaterThanEq :t :minimum
set :minimum :t
set :icon @titanium
label *label22
op greaterThan *tmp50 :a 5
op sub *tmp51 21 :a
op lessThan *tmp52 *tmp51 :minimum
op land :showa *tmp50 *tmp52
select :icon notEqual :showa false @surge-alloy :icon
op mod :column :index 2
op idiv :row :index 2
op mul *tmp57 :column .BAR_SPACE
op add :x 5 *tmp57
op mul *tmp59 :row 22
op add :y 4 *tmp59
op sub :xm1 :x 1
op sub :ym1 :y 1
draw color 0 0 80 255
draw rect :xm1 :ym1 .BAR_SPACE 16
op greaterThan *tmp63 :minimum 16
op equal *tmp64 :showa 0
op land *tmp65 *tmp63 *tmp64
select :icon notEqual *tmp65 false @surge-smelter :icon
draw color 255 255 255 255
jump *label28 equal :e false
jump *label30 lessThanEq :power 0
op add *tmp70 :x 7
op add *tmp71 :y 7
draw image *tmp70 *tmp71 :icon 16 0
jump *label29 always
label *label30
op add :x12 :x 12
op add :y3 :y 3
draw color 255 80 80 255
draw rect :x :y3 14 8
draw color 0 0 0 255
op add *tmp74 :x 2
op add *tmp75 :y 5
draw rect *tmp74 *tmp75 8 4
draw rect :x12 :y3 2 2
op add *tmp76 :y 9
draw rect :x12 *tmp76 2 2
draw color 255 80 80 255
op add *tmp77 :x 4
op add *tmp78 :y 6
draw rect *tmp77 *tmp78 2 2
jump *label29 always
label *label28
op add :x2 :x 2
op add :y2 :y 2
op add :x12 :x 12
op add :y12 :y 12
draw color 255 80 80 255
draw stroke 3
draw line :x2 :y12 :x12 :y2
draw line :x2 :y2 :x12 :y12
draw color 0 0 0 255
draw lineRect :xm1 :ym1 16 16
draw stroke 2
label *label29
op add :x *tmp57 21
op mul *tmp84 :power :e
jump *label32 notEqual *tmp84 0
set :red 255
set :green 0
set :blue 0
jump *label33 always
label *label32
jump *label34 equal :showa false
set :red 255
set :green 0
set :blue 255
set :minimum :a
jump *label35 always
label *label34
op greaterThan *tmp88 :minimum 14
op greaterThanEq *tmp89 :boost EXPECTED_BOOST
op land *tmp90 *tmp88 *tmp89
select :red notEqual *tmp90 false 0 255
select :green greaterThan :minimum 7 255 0
set :blue 0
label *label35
label *label33
jump *label40 lessThanEq :boost EXPECTED_BOOST
op max :red 192 :red
op max :green 192 :green
op max :blue 192 :blue
set :boost EXPECTED_BOOST
label *label40
op mul *tmp99 .BAR_LENGTH :boost
op idiv :length *tmp99 EXPECTED_BOOST
draw color :red :green :blue 128
op mul *tmp101 :minimum :length
op idiv *tmp102 *tmp101 20
draw rect :x :y *tmp102 14
draw color :red :green :blue 255
draw lineRect :x :y :length 14
op add :index :index 1
label *label14
op add :n :n 1
jump *label42 lessThan :n @links
label *label13
drawflush display1
op sub *tmp105 @time :start
op floor *tmp106 *tmp105
print "\nUpdate time: {0} ms"
format *tmp106
printflush message1
sensor *tmp8 switch1 @enabled
jump *label43 equal *tmp8 0
